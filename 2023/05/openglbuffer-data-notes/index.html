<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4843403245883139"
     crossorigin="anonymous"></script>

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.132.2 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Wang Aiguo">
<meta name="keywords" content="OpenGL, Buffer Data, Memory, glBufferData">
<meta name="description" content="keywords: OpenGL, buffer data, glBufferData, memory type">


<meta property="og:description" content="keywords: OpenGL, buffer data, glBufferData, memory type">
<meta property="og:type" content="article">
<meta property="og:title" content="[OpenGL]Buffer Data Notes">
<meta name="twitter:title" content="[OpenGL]Buffer Data Notes">
<meta property="og:url" content="http://localhost:1313/2023/05/openglbuffer-data-notes/">
<meta property="twitter:url" content="http://localhost:1313/2023/05/openglbuffer-data-notes/">
<meta property="og:site_name" content="玄冬Wong">
<meta property="og:description" content="keywords: OpenGL, buffer data, glBufferData, memory type">
<meta name="twitter:description" content="keywords: OpenGL, buffer data, glBufferData, memory type">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2023-05-28T23:07:00">
  
  
    <meta property="article:modified_time" content="2023-05-28T23:07:00">
  
  
  
    
      <meta property="article:section" content="OpenGL">
    
  
  
    
      <meta property="article:tag" content="OpenGL">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@dawn_arc">


  <meta name="twitter:creator" content="@dawn_arc">






  <meta property="og:image" content="http://localhost:1313/thumbnail/beijing/thumbnail-beijing-018.jpg">
  <meta property="twitter:image" content="http://localhost:1313/thumbnail/beijing/thumbnail-beijing-018.jpg">





  <meta property="og:image" content="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=640">


    <title>[OpenGL]Buffer Data Notes</title>

    <link rel="icon" href="http://localhost:1313/favicon.png">
    

    

    <link rel="canonical" href="http://localhost:1313/2023/05/openglbuffer-data-notes/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="http://localhost:1313/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet" href="http://localhost:1313/cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/paraiso-light.min.css">
      
    

    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4P9RSN4PXQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4P9RSN4PXQ');
</script>
  
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="http://localhost:1313/">玄冬Wong</a>
  </div>
  
    
      <a class="header-right-picture "
         href="http://localhost:1313/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=90" alt="Author&#39;s picture" />
      
    
    </a>
    
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="http://localhost:1313/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Wang Aiguo</h4>
        
          <h5 class="sidebar-profile-bio">白金翰大堂经理</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://localhost:1313/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/1645289/protoss" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.facebook.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.instagram.com/dawn_arc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-instagram"></i>
      
      <span class="sidebar-button-desc">Instagram</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/dawnarc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.pinterest.com/wangaiguo/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-pinterest"></i>
      
      <span class="sidebar-button-desc">Pinterest</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://steamcommunity.com/id/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-steam"></i>
      
      <span class="sidebar-button-desc">Steam</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/dawn_arc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://weibo.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
      
      <span class="sidebar-button-desc">Weibo</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      [OpenGL]Buffer Data Notes
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2023-05-28T23:07:00&#43;08:00">
        
  
  
  
  
    Sunday, 23:07, May 28, 2023
  

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="http://localhost:1313/categories/opengl">OpenGL</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
			<amp-auto-ads type="adsense"
					data-ad-client="ca-pub-4843403245883139">
			</amp-auto-ads>
            <div class="main-content-wrap">
                <ins class="adsbygoogle"
                     style="display:block;height:120px"
                     data-ad-client="ca-pub-4843403245883139"
                     data-ad-slot="2321022024"
                     data-ad-format="fluid"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
              <p>keywords: OpenGL, buffer data, glBufferData, memory type</p>
<h5 id="memory-type">Memory Type</h5>
<ul>
<li>system memory: CPU-side memory, usually called RAM.</li>
<li>video memory: memory on video card (Mainstream is PCI Express), usually called VRAM.</li>
<li>AGP memory: Accelerated Graphics Port, the opposite of PCI Express, obsoleted connector on PC.</li>
<li>shared memory:
<ul>
<li>on integrated GPUs, shared memory is just the system memory;</li>
<li>take OpenGL for example, call <code>glBufferStorage</code> with <code>GL_CLIENT_STORAGE_BIT</code> to allocate CPU-side memory.</li>
<li>take D3D12 as an example, <code>D3D12_HEAP_TYPE_CUSTOM</code> heap is the shared memory (on NUMA platform set <code>MemoryPoolPreference</code>as <code>D3D12_MEMORY_POOL_L0</code>);</li>
<li>for Vulkan, call <code>VmaAllocationCreateInfo()</code> with <code>VK_MEMORY_PROPERTY_HOST_CACHED_BIT</code> which is set to <code>VmaAllocationCreateInfo::preferredFlags</code>.</li>
</ul>
</li>
</ul>
<p>Reference:<br>
System memory,AGP memory和video memory<br>
<a href="https://blog.csdn.net/xiajun07061225/article/details/7288365">https://blog.csdn.net/xiajun07061225/article/details/7288365</a></p>
<h5 id="gl_static_draw-gl_stream_draw-gl_dynamic_draw">GL_STATIC_DRAW, GL_STREAM_DRAW, GL_DYNAMIC_DRAW</h5>
<p>Difference (credits to <a href="https://www.reddit.com/r/opengl/comments/57i9cl/comment/d8s8wnq/?utm_source=share&amp;utm_medium=web2x&amp;context=3">redditor: RowYourUpboat</a>):</p>
<ul>
<li><code>GL_STATIC_DRAW</code>: basically means &ldquo;I will load this vertex data once and then never change it.&rdquo; This would include any static props or level geometry, but also animated models/particles if you are doing all the animation with vertex shaders on the GPU (modern engines with skeletal animation do this, for example).</li>
<li><code>GL_STREAM_DRAW</code>: basically means &ldquo;I am planning to change this vertex data basically every frame.&rdquo; If you are manipulating the vertices a lot on the CPU, and it&rsquo;s not feasible to use shaders instead, you probably want to use this one. Sprites or particles with complex behavior are often best served as STREAM vertices. While STATIC+shaders is preferable for animated geometry, modern hardware can spew incredible amounts of vertex data from the CPU to the GPU every frame without breaking a sweat, so you will generally not notice the performance impact.</li>
<li><code>GL_DYNAMIC_DRAW</code>: basically means &ldquo;I may need to occasionally update this vertex data, but not every frame.&rdquo; This is the least common one. It&rsquo;s not really suited for most forms of animation since those usually require very frequent updates. Animations where the vertex shader interpolates between occasional keyframe updates are one possible case. A game with Minecraft-style dynamic terrain might try using DYNAMIC, since the terrain changes occur less frequently than every frame. DYNAMIC also tends to be useful in more obscure scenarios, such as if you&rsquo;re batching different chunks of model data in the same vertex buffer, and you occasionally need to move them around.</li>
</ul>
<p>Quoted from <a href="https://registry.khronos.org/OpenGL-Refpages/es1.1/xhtml/glBufferData.xml">glBufferData - khronos.org</a>:</p>
<ul>
<li><code>GL_STATIC_DRAW</code>: The data store contents will be modified once and used many times as the source for GL drawing commands.</li>
<li><code>GL_DYNAMIC_DRAW</code>: The data store contents will be modified repeatedly and used many times as the source for GL drawing commands.</li>
</ul>
<p>OpenGL缓冲区对象允许usage标示符取以下9种值（credits to <a href="https://blog.csdn.net/kunluo/article/details/72818069">kunluo - CSDN</a>）：</p>
<ul>
<li><code>GL_STATIC_DRAW</code>, <code>GL_STATIC_READ</code>, <code>GL_STATIC_COPY</code></li>
<li><code>GL_DYNAMIC_DRAW</code>, <code>GL_DYNAMIC_READ</code>, <code>GL_DYNAMIC_COPY</code></li>
<li><code>GL_STREAM_DRAW</code>, <code>GL_STREAM_READ</code>, <code>GL_STREAM_COPY</code></li>
</ul>
<p>区别：</p>
<ul>
<li>&ldquo;static&quot;意味着buffer的数据不会被改变（一次修改，多次使用）；</li>
<li>&ldquo;dynamic&quot;意味着数据可以被频繁修改（多次修改，多次使用）；</li>
<li>&ldquo;stream&quot;意味着数据每帧都不同（一次修改，一次使用）；</li>
<li>&ldquo;Draw&quot;意味着数据将会被送往GPU进行绘制，&ldquo;read&quot;意味着数据会被用户的应用读取，&ldquo;copy&quot;意味着数据会被用于绘制和读取。</li>
</ul>
<p><span class="highlight-text red">注意在使用VBO时，只有draw是有效的，而copy和read主要将会在像素缓冲区（PBO）和帧缓冲区（FBO）中发挥作用。</span><br>
系统会根据usage标示符为缓冲区对象分配最佳的存储位置，比如系统会为GL_STATIC_DRAW和GL_STREAM_DRAW分配显存，GL_DYNAMIC_DRAW分配AGP，以及任何_READ_相关的缓冲区对象都会被存储到系统或者AGP中因为这样数据更容易读写。</p>
<p>References:<br>
How to choose between GL_STREAM_DRAW or GL_DYNAMIC_DRAW<br>
<a href="https://stackoverflow.com/a/63445983/1645289">https://stackoverflow.com/a/63445983/1645289</a></p>
<h5 id="glbufferstorage">glBufferStorage</h5>
<p>Credits to <a href="https://www.reddit.com/r/opengl/comments/6v9yiw/comment/dlyxtpt/?utm_source=share&amp;utm_medium=web2x&amp;context=3">redditor</a>:</p>
<ul>
<li>Use <code>glBufferStorage</code> with <code>flags = 0</code> to allocate local GPU memory. You can then call <code>glBufferStorage</code> with <code>GL_CLIENT_STORAGE_BIT</code> to allocate CPU-side memory (with appropriate map read/write bits), and use <code>glCopyBufferSubData</code> to copy from one to the other. You can also copy from GPU buffer to GPU buffer, in case your data is generated by eg. a compute shader that writes to buffer.</li>
<li>If you use <code>glBufferData</code>, then what the implementation does with your memory is under-specified. Guaranteed it&rsquo;s not doing anything like &ldquo;avoiding a local CPU copy of your data&rdquo;.</li>
<li><code>glMapBuffer</code> does not allow you to directly modify GPU memory. It either causes the buffer to be stored on the CPU, or it&rsquo;s giving you a temporary copy of the buffer (on the CPU) which it copies back to the GPU at the end. Also, if it did give you a direct GPU pointer, it would either hard sync the GPU, or force you to be very careful not to overwrite parts of the buffer currently being processed. If you&rsquo;re explicitly implementing CPU/GPU copies yourself, then you have to implement this double-buffering yourself, which means having 1 GPU buffer and N CPU buffers (for N-buffering)</li>
</ul>
<p>Documents:<br>
<a href="https://www.intel.cn/content/dam/develop/external/us/en/documents/opengl-performance-tips-atomic-counter-buffers-versus-shader-storage-buffer-objects.pdf">OpenGL Performance Tips: Atomic Counter Buffers versus Shader Storage Buffer Objects</a></p>
<h5 id="glmapbuffer-vs-glbuffersubdata">glMapBuffer vs. glBufferSubData</h5>
<p>Quoted from [<a href="https://stackoverflow.com/a/32224290/1645289">Is it better glBufferSubData or glMapBuffer - StackOverflow</a>]:<br>
The good thing about <code>glMapBuffer</code> is that you dont need to copy the data first in an array and then use <code>glBufferSubData</code> to fill the opengl buffer. With <code>glMapBuffer</code>, you can copy the data directly to part of memory which opengl will fetch to GPU when it is necessary. From my point of view, there <code>glMapBuffer</code> should be faster when you want to fill a big buffer which is going to be updated frequently. Also, how you are copying the data into the buffer between <code>glMapBuffer</code> and glUnmapBuffer is also important.</p>
<p>If show us the code which you are using the <code>glMapBuffer</code> and how big is the data, then we can judge easier. Anyway, in the end measurements can show you which one is better.</p>
<p>Documents:<br>
<a href="https://www.khronos.org/opengl/wiki/Synchronization">Implicit synchronization - khronos.org</a></p>
<h5 id="gl_array_buffer-vs-gl_element_array_buffer">GL_ARRAY_BUFFER vs. GL_ELEMENT_ARRAY_BUFFER</h5>
<p>This has mostly historic reasons. Back when there were no VBOs, the pointers specified with <code>glVertexPointer</code> and similar were not &ldquo;associated&rdquo; with a OpenGL object of any kind. When VBOs got introduced this behavior carried over into the semantics of VBOs, which required a different buffer target for indices and attributes.</p>
<p>With the introduction of generic vertex attributes such an association functionality has been added.</p>
<p>Today it&rsquo;s mostly of a hint to the OpenGL implementation to know, in which way the data is going to be addressed, to optimize the data flow accordingly. But it also functions well as a mental reminder to the programmer, what&rsquo;s currently dealt with.</p>
<p>Origin:<br>
<a href="https://stackoverflow.com/a/15095302/1645289">https://stackoverflow.com/a/15095302/1645289</a></p>
<h5 id="how-to-upload-vertices-which-addressed-by-vao-to-gpu-memory">How to upload vertices which addressed by VAO to GPU memory</h5>
<p>Quoted from <a href="https://github.com/skanti/Mesh-Voxelization-OpenGL-Geometry-Shader">Mesh-Voxelization</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    Eigen<span style="color:#f92672">::</span>Matrix<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">float</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span> V;		<span style="color:#75715e">//vertex buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    Eigen<span style="color:#f92672">::</span>Matrix<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">uint32_t</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&gt;</span> F;	<span style="color:#75715e">//triangle index buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} mesh;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    GLuint program;
</span></span><span style="display:flex;"><span>    GLuint id_vao;
</span></span><span style="display:flex;"><span>    GLuint id_vbo_position;
</span></span><span style="display:flex;"><span>    GLuint id_ebo;
</span></span><span style="display:flex;"><span>} vao;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init_vao</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">/* interpolate the vertex (attributes and indices) into &#39;mesh&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	using geometry library such as Assimp or glTF. 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">	*/</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">load_mesh</span>(<span style="color:#e6db74">&#34;C:/monkey.obj&#34;</span>, mesh)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//vao
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	GLuint shaders[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> { vs, gs, fs };
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">create_program</span>(vao_voxelization.program, shaders, <span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glUseProgram</span>(vao_voxelization.program);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glGenVertexArrays</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>vao_voxelization.id_vao);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBindVertexArray</span>(vao_voxelization.id_vao);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//position (buffer object)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">glGenBuffers</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>vao_voxelization.id_vbo_position);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBindBuffer</span>(GL_ARRAY_BUFFER, vao_voxelization.id_vbo_position);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBufferData</span>(GL_ARRAY_BUFFER, mesh.F.<span style="color:#a6e22e">cols</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">sizeof</span>(GLfloat), mesh.V.<span style="color:#a6e22e">data</span>(), GL_STATIC_DRAW);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glVertexAttribPointer</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glEnableVertexAttribArray</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBindBuffer</span>(GL_ARRAY_BUFFER, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//elements (buffer object)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">glGenBuffers</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>vao_voxelization.id_ebo);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBindBuffer</span>(GL_ELEMENT_ARRAY_BUFFER, vao_voxelization.id_ebo);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBufferData</span>(GL_ELEMENT_ARRAY_BUFFER, mesh.F.<span style="color:#a6e22e">cols</span>() <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">sizeof</span>(GLuint), mesh.F.<span style="color:#a6e22e">data</span>(), GL_STATIC_DRAW);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">glBindBuffer</span>(GL_ELEMENT_ARRAY_BUFFER, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h5 id="vao-vertex-array-objects-vs-vbo-vertex-buffer-objects">VAO (Vertex Array Objects) vs VBO (Vertex Buffer Objects)</h5>
<p>Difference:</p>
<ul>
<li>Vertex Array Objects (VAOs) are conceptually nothing but thin state wrappers.</li>
<li>Vertex Buffer Objects (VBOs) store actual data.</li>
</ul>
<p>Origin: <a href="https://stackoverflow.com/a/23315318/1645289">Use of Vertex Array Objects and Vertex Buffer Objects - StackOverflow</a></p>
<h5 id="glactivetexture-vs-glbindtexture">glActiveTexture vs. glBindTexture</h5>
<p>Imagine the GPU like some paint processing plant.</p>
<p>There are a number of tanks, which delivers dye to some painting machine. In the painting machine the dye is then applied to the object. Those tanks are the texture units</p>
<p>Those tanks can be equipped with different kinds of dye. Each kind of dye requires some other kind of solvent. The &ldquo;solvent&rdquo; is the texture target. For convenience each tank is connected to some solvent supply, and but only one kind of solvent can be used at a time in each tank. So there&rsquo;s a valve/switch <code>TEXTURE_CUBE_MAP</code>, <code>TEXTURE_3D</code>, <code>TEXTURE_2D</code>, <code>TEXTURE_1D</code>. You can fill all the dye types into the tank at the same time, but since only one kind of solvent goes in, it will &ldquo;dilute&rdquo; only the kind of dye matching. So you can have each kind of texture being bound, but the binding with the &ldquo;most important&rdquo; solvent will actually go into the tank and mix with the kind of dye it belongs to.</p>
<p>And then there&rsquo;s the dye itself, which comes from a warehouse and is filled into the tank by &ldquo;binding&rdquo; it. That&rsquo;s your texture.</p>
<p>Origin: Differences and relationship between glActiveTexture and glBindTexture<br>
<a href="https://stackoverflow.com/a/8868942/1645289">https://stackoverflow.com/a/8868942/1645289</a></p>
<h5 id="glbindimagetexture-vs-glbindtexture">glBindImageTexture vs. glBindTexture</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#a6e22e">layout</span>(binding <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) uniform sampler2D img_input;
</span></span></code></pre></div><p>That declares a <a href="https://www.opengl.org/wiki/Sampler_%28GLSL%29">sampler</a>, which gets its data from a texture object. The binding of 0 (you can set that in the shader in GLSL 4.20) says that the 2D texture bound to texture image unit 0 (via <code>glActiveTexture(GL_TEXTURE0); glBindTexture(GL_TEXTURE_2D, ...);)</code> is the texture that will be used for this sampler.</p>
<p>Samplers use the entire texture, including all mipmap levels and array layers. Most texture sampling functions use normalized texture coordinates ([0, 1] map to the size of the texture). Most texture sampling functions also respect <a href="https://www.opengl.org/wiki/Sampler_Object#Sampling_parameters">filtering properties and other sampling parameters</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#a6e22e">layout</span> (binding <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, rgba32f) uniform image2D img_input;
</span></span></code></pre></div><p>This declares an image, which represents a single image from a texture. Textures can have <a href="https://www.opengl.org/wiki/Texture#Theory">multiple images</a>: mipmap levels, <a href="https://www.opengl.org/wiki/Array_Texture">array layers</a>, etc. When you use <code>glBindImageTexture</code>, you are binding a single image from a texture.</p>
<p>Images and samplers are completely separate. They have their own set of binding indices; it&rsquo;s perfectly valid to bind a texture to <code>GL_TEXTURE0</code> and an image from a different texture to image binding 0. Using texture functions for the associated sampler will read from what is bound to <code>GL_TEXTURE0</code>, while image functions on the associated image variable will read from the image bound to image binding 0.</p>
<p>Image access ignores all sampling parameters. <a href="https://www.opengl.org/wiki/Image_Load_Store#Image_operations">Image accessing functions</a> always use integer texel coordinates.</p>
<p>Samplers can only read data from textures; image variables can read and/or write data, as well as perform atomic operations on them. Of course, writing data from shaders requires special care, specifically when <a href="https://www.opengl.org/wiki/Memory_Model#Incoherent_memory_access">someone goes to read that data</a>.</p>
<p>Origin: What is the difference between glBindImageTexture() and glBindTexture()?<br>
<a href="https://stackoverflow.com/a/37140611/1645289">https://stackoverflow.com/a/37140611/1645289</a></p>
<h5 id="the-common-usage-of-uniform-buffer">The Common Usage of Uniform Buffer</h5>
<p>Most commonly used scenarios:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/69301997/android-opengl-es-3-0-skeletal-animations-glitch-with-ubo">Skeletal Animation</a></li>
</ul>
<h5 id="ubo-vs-ssbo-uniform-buffer-objects-shader-storage-buffer-objects">UBO vs SSBO (Uniform Buffer Objects, Shader Storage Buffer Objects)</h5>
<p>原文： <a href="http://wangyudong.xyz/?p=256">http://wangyudong.xyz/?p=256</a></p>
<ul>
<li>大小限制：UBO大小限制为KB级别，64KB或128KB，具体与硬件相关。而SSBO则灵活得多，大小可为显存大小（GB），因而更适合与存储大量的数据。而且SSBO可以在shader运行时再确定大小，而非编译时。</li>
<li>存取速度：UBO存储区为显卡的常量区，而SSBO为全局的显存，UBO速度高于SSBO。</li>
<li>读写：UBO对于shader来讲是只读常量，只能通过外部程序更新。SSBO则是shader可以读写的（例如在compute shader中更新顶点的位置）。</li>
<li>SSBO还有一个特点，就是任何其他类型的OpenGL buffer都可绑定到GL_SHADER_STORAGE_BUFFER 目标上，因而很灵活。</li>
</ul>
<p>RBO(Render Buffer Object)和texture在FBO(Frame Buffer Object)中都可以用于绑定相应的attachment，功能也比较相似。但是RBO效率更高，因为RBO中的数据采用OpenGL的内部格式，操作过程中无需转换格式。texture则必须转换为纹理颜色的格式。</p>
<p>Shader Storage Buffer Object<br>
<a href="https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object">https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object</a></p>
<h5 id="ubo-vs-tbo-uniform-buffer-objects-texture-buffer-objects">UBO vs TBO (Uniform Buffer Objects, Texture Buffer Objects)</h5>
<p>Uniform Buffers VS Texture Buffers<br>
<a href="https://www.rastergrid.com/blog/2010/01/uniform-buffers-vs-texture-buffers/">https://www.rastergrid.com/blog/2010/01/uniform-buffers-vs-texture-buffers/</a></p>
<h5 id="pbo-vs-fbo-pixel-buffer-objects-frame-buffer-objects">PBO vs FBO (Pixel Buffer Objects, Frame Buffer Objects)</h5>
<p>Quoted from: <a href="https://www.khronos.org/opengl/wiki/Pixel_Buffer_Object">Pixel Buffer Object</a><br>
PBOs have nothing to do with Framebuffer Objects. Note the capitalization; &ldquo;framebuffer&rdquo; is one word. FBOs are not buffer objects; PBOs are. FBOs are about rendering to off-screen images; PBOs are about pixel transfers to/from the user from/to images in OpenGL. They are not alike.</p>
<p>References:<br>
<a href="https://mp.weixin.qq.com/s?__biz=MzIwNTIwMzAzNg==&amp;mid=2654161764&amp;idx=1&amp;sn=cae0909d8ce82051d38fa0182704a25b">NDK OpenGL ES 3.0 开发（二十二）：PBO</a><br>
<a href="https://mp.weixin.qq.com/s?__biz=MzIwNTIwMzAzNg==&amp;mid=2654175120&amp;idx=2&amp;sn=6a76505812684229c60889ae703db0be">熟悉 OpenGL VAO、VBO、FBO、PBO 等对象，看这一篇就够了</a></p>
<hr>
<p><code>He who thinks too much about every step he takes will always stay on one leg. -Chinese Proverbs</code></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="http://localhost:1313/tags/opengl/">OpenGL</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://localhost:1313/2023/07/c-template-notes/" data-tooltip="[C&#43;&#43;]Template Notes">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://localhost:1313/2023/04/d3d12asynchronous-compute-notes/" data-tooltip="[D3D12]Asynchronous Compute Notes">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            <script src="https://utteranc.es/client.js"
  repo="dawnarc/dawnarc.github.io"
  issue-term="pathname"
  label="Comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2024 Wang Aiguo. All Rights Reserved. Powered by <A href="https://gohugo.io/"> Hugo</A> | Theme <A href="https://github.com/kakawait/hugo-tranquilpeak-theme/">Tranquilpeak</A>.
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://localhost:1313/2023/07/c-template-notes/" data-tooltip="[C&#43;&#43;]Template Notes">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://localhost:1313/2023/04/d3d12asynchronous-compute-notes/" data-tooltip="[D3D12]Asynchronous Compute Notes">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Wang Aiguo</h4>
    
      <div id="about-card-bio">白金翰大堂经理</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Yichang, Hubei
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('http://localhost:1313/images/cover-v1.2.0.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

	<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/school-book.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="http://localhost:1313/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
document.addEventListener('DOMContentLoaded', (event) => {
  document.querySelectorAll('pre code').forEach((el) => {
    hljs.highlightElement(el);
  });
});
</script>






    
  </body>
</html>

