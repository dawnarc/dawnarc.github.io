

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.42.1 with theme Tranquilpeak 0.4.3-BETA">
    <title>[Shading]OpenGL常用基础知识(个人学习笔记)</title>
    <meta name="author" content="Neil Wang">
    <meta name="keywords" content="">

    <link rel="icon" href="http://www.dawnarc.com/favicon.png">
    

    
    <meta name="description" content="文章内容大部分参考自《OpenGL 4 Shading Language Cookbook, Second Edition》书中的代码：
https://github.com/daw42/glslcookbook
术语解释：  GLEW (OpenGL Extension Wrangler). GLM (OpenGL Mathematics) GLFW is an Open Source, multi-platform library for OpenGL, OpenGL ES and Vulkan development on the desktop. It provides a simple API for creating windows, contexts and surfaces, receiving input and events.  Shader类型  vertex shader fragment shader geometry shader tess_control shader tess_evaluation shader compute shader  批量填充(populate)数据 OpenGL 4.0之前，比如要填充vertex数据，必须有逐个vertex设置。4.0之后，可以一次性填出一组vertex。
以填充position和color的vertex shader为例：">
    <meta property="og:description" content="文章内容大部分参考自《OpenGL 4 Shading Language Cookbook, Second Edition》书中的代码：
https://github.com/daw42/glslcookbook
术语解释：  GLEW (OpenGL Extension Wrangler). GLM (OpenGL Mathematics) GLFW is an Open Source, multi-platform library for OpenGL, OpenGL ES and Vulkan development on the desktop. It provides a simple API for creating windows, contexts and surfaces, receiving input and events.  Shader类型  vertex shader fragment shader geometry shader tess_control shader tess_evaluation shader compute shader  批量填充(populate)数据 OpenGL 4.0之前，比如要填充vertex数据，必须有逐个vertex设置。4.0之后，可以一次性填出一组vertex。
以填充position和color的vertex shader为例：">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="[Shading]OpenGL常用基础知识(个人学习笔记)">
    <meta property="og:url" content="/2017/01/shadingopengl%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
    <meta property="og:site_name" content="玄冬Wong">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="玄冬Wong">
    <meta name="twitter:description" content="文章内容大部分参考自《OpenGL 4 Shading Language Cookbook, Second Edition》书中的代码：
https://github.com/daw42/glslcookbook
术语解释：  GLEW (OpenGL Extension Wrangler). GLM (OpenGL Mathematics) GLFW is an Open Source, multi-platform library for OpenGL, OpenGL ES and Vulkan development on the desktop. It provides a simple API for creating windows, contexts and surfaces, receiving input and events.  Shader类型  vertex shader fragment shader geometry shader tess_control shader tess_evaluation shader compute shader  批量填充(populate)数据 OpenGL 4.0之前，比如要填充vertex数据，必须有逐个vertex设置。4.0之后，可以一次性填出一组vertex。
以填充position和color的vertex shader为例：">
    
      <meta name="twitter:creator" content="@idealsland">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=640">
    

    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="http://www.dawnarc.com/css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css" />
    
    
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css">
      
    

    
      
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-78064851-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="http://www.dawnarc.com/">玄冬Wong</a>
  </div>
  
    
      <a class="header-right-picture "
         href="http://www.dawnarc.com/#about">
    
    
    
      
        <img class="header-picture" src="//www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
  
  

</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="http://www.dawnarc.com/#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Neil Wang</h4>
        
          <h5 class="sidebar-profile-bio">久长唯有品格</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.dawnarc.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://stackoverflow.com/users/1645289/protoss" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.artstation.com/artist/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-artstation"></i>
      
      <span class="sidebar-button-desc">ArtStation</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.facebook.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dawnarc/CV" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://www.linkedin.com/in/dawnarc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.pinterest.com/wangaiguo/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-pinterest"></i>
      
      <span class="sidebar-button-desc">Pinterest</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://steamcommunity.com/id/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-steam"></i>
      
      <span class="sidebar-button-desc">Steam</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/idealsland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://weibo.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
      
      <span class="sidebar-button-desc">Weibo</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      [Shading]OpenGL常用基础知识(个人学习笔记)
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-01-13T14:28:40&#43;08:00">
        
  January 13, 2017

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="http://www.dawnarc.com/categories/shading">Shading</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              

<p>文章内容大部分参考自《OpenGL 4 Shading Language Cookbook, Second Edition》书中的代码：<br />
<a href="https://github.com/daw42/glslcookbook">https://github.com/daw42/glslcookbook</a></p>

<h5 id="术语解释">术语解释：</h5>

<ul>
<li><code>GLEW</code> (OpenGL Extension Wrangler).</li>
<li><code>GLM</code> (OpenGL Mathematics)</li>
<li><code>GLFW</code> is an Open Source, multi-platform library for OpenGL, OpenGL ES and Vulkan development on the desktop. It provides a simple API for creating windows, contexts and surfaces, receiving input and events.</li>
</ul>

<h4 id="shader类型">Shader类型</h4>

<ul>
<li>vertex shader</li>
<li>fragment shader</li>
<li>geometry shader</li>
<li>tess_control shader</li>
<li>tess_evaluation shader</li>
<li>compute shader</li>
</ul>

<h5 id="批量填充-populate-数据">批量填充(populate)数据</h5>

<p>OpenGL 4.0之前，比如要填充vertex数据，必须有逐个vertex设置。4.0之后，可以一次性填出一组vertex。<br />
以填充position和color的vertex shader为例：</p>

<pre><code>/////////////////// Create the VBO ////////////////////
float positionData[] = {
    -0.8f, -0.8f, 0.0f,
    0.8f, -0.8f, 0.0f,
    0.0f,  0.8f, 0.0f };
float colorData[] = {
    1.0f, 0.0f, 0.0f,
    0.0f, 1.0f, 0.0f,
    0.0f, 0.0f, 1.0f };

// Create and populate the buffer objects
GLuint vboHandles[2];
glGenBuffers(2, vboHandles);
GLuint positionBufferHandle = vboHandles[0];
GLuint colorBufferHandle = vboHandles[1];

glBindBuffer(GL_ARRAY_BUFFER, positionBufferHandle);
glBufferData(GL_ARRAY_BUFFER, 9 * sizeof(float), positionData, GL_STATIC_DRAW);

glBindBuffer(GL_ARRAY_BUFFER, colorBufferHandle);
glBufferData(GL_ARRAY_BUFFER, 9 * sizeof(float), colorData, GL_STATIC_DRAW);

// Create and set-up the vertex array object
glGenVertexArrays(1, &amp;vaoHandle);
glBindVertexArray(vaoHandle);

glEnableVertexAttribArray(0);  // Vertex position
glEnableVertexAttribArray(1);  // Vertex color

//break current vertex array object binding.
glBindBuffer(GL_ARRAY_BUFFER, positionBufferHandle);
glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, (GLubyte *)NULL);

glBindBuffer(GL_ARRAY_BUFFER, colorBufferHandle);
glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, (GLubyte *)NULL);
glBindVertexArray(0);
</code></pre>

<h5 id="多个program切换">多个Program切换</h5>

<p>可以在一个OpenGL程序中创建多个Program对象（<code>glCreateProgram</code>创建），然后通过<code>glUseProgram</code>且切换使用需要的Program对象。</p>

<h5 id="删除program对象">删除Program对象</h5>

<p>如果一个Program对象不再使用，可以使用<code>glDeleteProgram</code>删除；如果这个Program正在使用，使用<code>glDeleteProgram</code>不会直接删除，而是给一个删除标记，等到下次OpenGL内部检测时才会删除。<br />
删除一个Program对象后，会自动Detach之前Attach上去的所有ShaderObject（<code>glCreateShader</code>创建），但是不会删除这些ShaderObject，除非调用<code>glDeleteShader</code>。</p>

<h5 id="动态获取-vertex-input-attributes">动态获取 vertex input attributes</h5>

<p>一般情况下，vertex输入属性是在shader代码中定义好的：</p>

<pre><code>#version 410

layout (location=0) in vec3 VertexPosition;
layout (location=1) in vec3 VertexColor;
</code></pre>

<p>或者是在Program对象link之前（<code>glLinkProgram</code>），通过<code>glBindAttribLocation</code>来绑定索引：</p>

<pre><code>//programHandle是已经创建好的Program对象
glBindAttribLocation(programHandle, 0, &quot;VertexPosition&quot;);
glBindAttribLocation(programHandle, 1, &quot;VertexColor&quot;);
</code></pre>

<p>那么有没办法在Program对象Link之后，再去查询获取vertex attributes的location等信息？方式如下：</p>

<pre><code>//获取输入属性的个数
GLint numAttribs;
glGetProgramInterfaceiv(programHandle, GL_PROGRAM_INPUT, GL_ACTIVE_RESOURCES, &amp;numAttribs);

//获取每个输入属性的名字、类型、索引
GLenum properties[] = {GL_NAME_LENGTH, GL_TYPE, GL_LOCATION};
printf(&quot;Active attributes:\n&quot;);
for( int i = 0; i &lt; numAttribs; ++i ) 
{
    GLint results[3];
    glGetProgramResourceiv(programHhandle, GL_PROGRAM_INPUT, i, 3, properties, 3, NULL, results);
    GLint nameBufSize = results[0] + 1;
    char * name = new char[nameBufSize];
    glGetProgramResourceName(programHandle, GL_PROGRAM_INPUT, i, nameBufSize, NULL, name);
    printf(&quot;%-5d %s (%s)\n&quot;, results[2], name, getTypeString(results[1]));
    delete [] name;
}
</code></pre>

<div class="alert warning ">
  <p>glGetProgramInterfaceiv、glGetProgramResourceiv、glGetProgramResourceName是OpenGL 4.3才提供的API。4.3之前的版本可以使用 glGetProgramiv、glGetActiveAttrib、glGetAttribLocation等接口来实现上述需求。</p>
</div>

<p>输出结果：</p>

<pre><code>Active attributes:
1    VertexColor (vec3)
0    VertexPosition (vec3)
</code></pre>

<h5 id="uniform-variables的意义和作用">Uniform variables的意义和作用</h5>

<p>前面介绍的 Vertex attributes 是一种通用的给 shader 填充输入参数的方式，Vertext attributes 在 shader 内部不仅可以被读取，还可以被修改。<br />
但是 Uniform variables 在 shader 内只能被读取，如果要修改，必须在 shader 之外调用OpenGL的API。</p>

<p>什么情况下用Uniform variable：<br />
在渲染一个模型时，由于其每个顶点(vertex)信息都不一样，所以每个顶点在调用 shader 时，shader 的输入参数都不一样，相当于每计算一个顶点，shader 的输入参数都得变化一次，针对这种实时变化的输入参数，最好使用 Vertex attributes ；对于像摄像机角度、投射变换(projective transformations)等数据，相对变化频率很低，这种情况下最好使用 Uniform variable，毕竟它在 shader 内为常量，所以编译器可以针对这种常量做优化来提升性能。</p>

<p>注意事项：<br />
Uniform variables 可以定义在任何一个 shader 中，如果多个 shader 定义了名字相同的 Uniform variables，那么他么的类型也必须相同，也就是说：<span class="highlight-text green">只要一处定义，就可以可以被当前程序的所有 shader 对象访问</span>。</p>

<h5 id="uniform-variables-常用的opengl-api">Uniform variables 常用的OpenGL API</h5>

<p>假设测试的 uniform.frag 代码如下：</p>

<pre><code>#version 410

layout (location = 0) in vec3 VertexPosition;
layout (location = 1) in vec3 VertexColor;

out vec3 Color;
uniform mat4 RotationMatrix;

void main()
{
    Color = VertexColor;
    gl_Position = RotationMatrix * vec4(VertexPosition,1.0);
}
</code></pre>

<p>那么OpenGL API获取并设置Uniform variables的方式如下：</p>

<pre><code>rotationMatrix = glm::rotate(glm::mat4(1.0f), angle, vec3(0.0f,0.0f,1.0f));

GLuint programHandle = prog.getHandle();
//获取 Uniform variables 索引
GLuint location = glGetUniformLocation(programHandle, &quot;RotationMatrix&quot;);
//通过索引获取 Uniform variables 的值
glUniformMatrix4fv(location, 1, GL_FALSE, &amp;rotationMatrix[0][0]);
</code></pre>

<p>常用技巧：</p>

<ul>
<li>如果要使用vec3作为 Uniform variables 类型，那么可以使用 <code>glUniform3f</code> 或者 <code>glUniform3fv</code>，<span class="highlight-text green"> 后缀带'v'的表示数组类型 </span>。</li>

<li><p>通过数组索引访问 Uniform variables ：</p>

<pre><code>GLuint location = glGetUniformLocation( programHandle, &quot;MyArray[1]&quot; );
</code></pre></li>

<li><p>通过结构体成员变量访问 Uniform variables ：</p>

<pre><code>GLuint location = glGetUniformLocation( programHandle, &quot;MyMatrices.Rotation&quot; );
</code></pre></li>
</ul>

<h5 id="动态获取-uniform-variables">动态获取 Uniform variables</h5>

<p>方式类似前面提到的<strong>动态获取 vertex input attributes</strong>，还是以前面的 uniform.frag 为例：</p>

<pre><code>GLint numUniforms = 0;
glGetProgramInterfaceiv( handle, GL_UNIFORM, GL_ACTIVE_RESOURCES, &amp;numUniforms);

GLenum properties[] = {GL_NAME_LENGTH, GL_TYPE, GL_LOCATION, GL_BLOCK_INDEX};
printf(&quot;Active uniforms:\n&quot;);
for( int i = 0; i &lt; numUniforms; ++i ) 
{
    GLint results[4];
    glGetProgramResourceiv(handle, GL_UNIFORM, i, 4, properties, 4, NULL, results);
    if( results[3] != -1 ) 
        continue;       // Skip uniforms in blocks 
    GLint nameBufSize = results[0] + 1;
    char * name = new char[nameBufSize];
    glGetProgramResourceName(handle, GL_UNIFORM, i, nameBufSize, NULL, name);
    printf(&quot;%-5d %s (%s)\n&quot;, results[2], name, getTypeString(results[1]));
    delete [] name;
}
</code></pre>

<div class="alert warning ">
  <p>OpenGL 4.3 之前的版本，则要使用：glGetProgramiv、glGetActiveUniform、glGetUniformLocation、and glGetActiveUniformName.</p>
</div>

<p>打印结果：</p>

<pre><code>Active uniforms:
0    RotationMatrix (mat4)
</code></pre>

<h5 id="uniform-blocks意义和作用">Uniform blocks意义和作用</h5>

<p>如果你的 OpenGL 程序中有多个 shader 对象，且这些 shader 使用了同一个 Uniform variables，而我们知道，Uniform variables的location等信息是在 shader 对象Link之后生成的，也就是说没当 Link 一个 shader对象时，这个Uniform variables 的location 可能发生变化（比如在 shader 对象A中，Uniform variables 的location 为1，shader 对象2中，那么Uniform variables 的location 为2，那么如果先link对象A，再link对象B，则这个Uniform variables的location对于 shader 对象A就已失效）。<br />
所以需要一个管理当前Program对象中所有Uniform variables的管理器，这个管理器就是Uniform blocks。</p>

<p>使用实例：</p>

<p>以下代码是绘制一个同心圆渐变效果的 shader。</p>

<p>buniformblock.frag</p>

<pre><code>#version 430

layout (location = 0) in vec3 VertexPosition;
layout (location = 1) in vec3 VertexTexCoord;

out vec3 TexCoord;

void main()
{
    TexCoord = VertexTexCoord;
    gl_Position = vec4(VertexPosition,1.0);
}
</code></pre>

<p>basic_uniformblock.vert</p>

<pre><code>#version 430

in vec3 TexCoord;
layout (location = 0) out vec4 FragColor;

layout (binding = 1) uniform BlobSettings {
  vec4 InnerColor;
  vec4 OuterColor;
  float RadiusInner;
  float RadiusOuter;
} Blob;

void main() 
{
    float dx = TexCoord.x - 0.5;
    float dy = TexCoord.y - 0.5;
    float dist = sqrt(dx * dx + dy * dy);
    FragColor =
       mix( Blob.InnerColor, Blob.OuterColor,
             smoothstep( Blob.RadiusInner, Blob.RadiusOuter, dist )
            );
}
</code></pre>

<p>OpenGL API 代码：</p>

<pre><code>GLuint programHandle = prog.getHandle();

// Get the index of the uniform block
GLuint blockIndex = glGetUniformBlockIndex(programHandle, &quot;BlobSettings&quot;);

// Allocate space for the buffer
GLint blockSize;
glGetActiveUniformBlockiv(programHandle, blockIndex,
                          GL_UNIFORM_BLOCK_DATA_SIZE, &amp;blockSize);
GLubyte * blockBuffer;
blockBuffer = (GLubyte *) malloc(blockSize);

// Query for the offsets of each block variable
const GLchar *names[] = { &quot;BlobSettings.InnerColor&quot;, &quot;BlobSettings.OuterColor&quot;,
                          &quot;BlobSettings.RadiusInner&quot;, &quot;BlobSettings.RadiusOuter&quot; };

GLuint indices[4];
glGetUniformIndices(programHandle, 4, names, indices);

GLint offset[4];
glGetActiveUniformsiv(programHandle, 4, indices, GL_UNIFORM_OFFSET, offset);

// Store data within the buffer at the appropriate offsets
GLfloat outerColor[] = {0.0f, 0.0f, 0.0f, 0.0f};
GLfloat innerColor[] = {1.0f, 1.0f, 0.75f, 1.0f};
GLfloat innerRadius = 0.25f, outerRadius = 0.45f;

memcpy(blockBuffer + offset[0], innerColor, 4 * sizeof(GLfloat));
memcpy(blockBuffer + offset[1], outerColor, 4 * sizeof(GLfloat));
memcpy(blockBuffer + offset[2], &amp;innerRadius, sizeof(GLfloat));
memcpy(blockBuffer + offset[3], &amp;outerRadius, sizeof(GLfloat));

// Create the buffer object and copy the data
GLuint uboHandle;
glGenBuffers( 1, &amp;uboHandle );
glBindBuffer( GL_UNIFORM_BUFFER, uboHandle );
glBufferData( GL_UNIFORM_BUFFER, blockSize, blockBuffer, GL_DYNAMIC_DRAW );

// Bind the buffer object to the uniform block
glBindBufferBase( GL_UNIFORM_BUFFER, 1, uboHandle );
</code></pre>

<h5 id="glbufferdata的作用">glBufferData的作用</h5>

<p>Create the buffer object and copy the data into it:</p>

<pre><code>GLuint uboHandle;
glGenBuffers( 1, &amp;uboHandle );
glBindBuffer( GL_UNIFORM_BUFFER, uboHandle );
glBufferData( GL_UNIFORM_BUFFER, blockSize, blockBuffer, GL_DYNAMIC_DRAW );
</code></pre>

<p>The space is allocated within the buffer object and the data is copied when glBufferData is called.</p>

<h5 id="glbindbufferbase的索引问题">glBindBufferBase的索引问题</h5>

<p>glBindBufferBase函数参数的索引（第二个参数）必须与定义uniform时设定的layout(binding=)相同，例如：</p>

<pre><code>glBindBufferBase(GL_UNIFORM_BUFFER, 0, uboHandle);
</code></pre>

<p>对应的uniform定义</p>

<pre><code>layout (binding = 0) uniform BlobSettings {
    vec4 InnerColor;
    vec4 OuterColor;
    float RadiusInner;
    float RadiusOuter;
};
</code></pre>

<h5 id="glbindbuffer与glbindbufferbase的区别">glBindBuffer与glBindBufferBase的区别</h5>

<div class="alert info ">
  <p>简述之：<code>glBindBuffer</code> 绑定的指针索引，是用来对 Buffer 填充或修改数据而使用的，但是这个索引无法作为输入参数传递给 shader ，如果要把这个索引传递给 shader ，那么比如使用glBindBufferBase。</p>
</div>

<p>书中原文：<br />
You might be wondering why we use glBindBuffer and glBindBufferBase with GL_UNIFORM_BUFFER. Aren&rsquo;t these the same binding points used in two different contexts? The answer is that the GL_UNIFORM_BUFFER point can be used in each function with a slightly different meaning. With glBindBuffer, we bind to a point that can be used for filling or modifying a buffer, but can&rsquo;t be used as a source of data for the shader. When we use glBindBufferBase, we are binding to an index within a location that can be directly sourced by the shader. Granted, that&rsquo;s a bit confusing.</p>

<h5 id="uniform-layout类型">uniform layout类型：</h5>

<ul>
<li>std140</li>
<li>shared</li>
<li>packed</li>
<li>row_major</li>
<li>column_major</li>
</ul>

<p>例如：</p>

<pre><code>layout( std140 ) uniform BlobSettings {
};
</code></pre>

<p>多个修饰符可以组合使用：</p>

<pre><code>layout( row_major, shared ) uniform BlobSettings {
};
</code></pre>

<h5 id="fragment-shader到vertex-shader之间的工作流程-page-58">fragment shader到vertex shader之间的工作流程（page 58）</h5>


<figure>
    
        <img src="http://www.dawnarc.com/img/20170113-[Shading]%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0/[Shading]%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0-01.jpg" />
    
    
</figure>


<p>Between the vertex and fragment shader, the vertices are assembled into primitives, clipping takes place, and the viewport transformation is applied (among other operations). The rasterization process then takes place and the polygon is filled (if necessary). The fragment shader is executed once for each fragment (pixel) of the polygon being rendered (typically in parallel). Data provided from the vertex shader is (by default) interpolated in a perspective correct manner, and provided to the fragment shader via shader input variables. The fragment shader determines the appropriate color for the pixel and sends it to the frame buffer using output variables. The depth information is handled automatically.</p>

<hr />

<p><code>莫道不消魂？帘卷西风，人比黄花瘦。---李清照《醉花阴》</code></p>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="http://www.dawnarc.com/tags/graphics/">Graphics</a>

  <a class="tag tag--primary tag--small" href="http://www.dawnarc.com/tags/opengl/">OpenGL</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://www.dawnarc.com/2017/01/zbrush%E5%85%B3%E4%BA%8E%E7%BC%A9%E6%94%BE%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" data-tooltip="[ZBrush]关于缩放的三种方式">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://www.dawnarc.com/2017/01/zbrush%E5%B8%B8%E7%94%A8%E7%AC%94%E5%88%B7brush/" data-tooltip="[ZBrush]常用笔刷(brush)">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Neil Wang. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://www.dawnarc.com/2017/01/zbrush%E5%85%B3%E4%BA%8E%E7%BC%A9%E6%94%BE%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" data-tooltip="[ZBrush]关于缩放的三种方式">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="http://www.dawnarc.com/2017/01/zbrush%E5%B8%B8%E7%94%A8%E7%AC%94%E5%88%B7brush/" data-tooltip="[ZBrush]常用笔刷(brush)">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Neil Wang</h4>
    
      <div id="about-card-bio">久长唯有品格</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        TechArtist
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Yichang·Hubei
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/openglrendering-pipeline%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0/">
                <h3 class="media-heading">[OpenGL]Rendering Pipeline(渲染管线)流程概述</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Pipeline    (The blue boxes are programmable shader stages.)
The OpenGL rendering pipeline works in the following order:
 Prepare vertex array data, and then render it Vertex Processing:  Each vertex is acted upon by a Vertex Shader. Each vertex in the stream is processed in turn into an output vertex. Optional primitive tessellation stages. Optional Geometry Shader primitive processing. The output is a sequence of primitives.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/dlangc--%E7%9B%B8%E5%AF%B9d%E7%9A%84%E4%BC%98%E7%82%B9/">
                <h3 class="media-heading">[Dlang]C&#43;&#43;相对D的优点</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">原文：What does C++ do better than D?
https://softwareengineering.stackexchange.com/questions/97207/what-does-c-do-better-than-d
Most of the things C++ &ldquo;does&rdquo; better than D are meta things:
C++ has better compilers, better tools, more mature libraries, more bindings, more experts, more tutorials etc. Basically it has more and better of all the external things that you would expect from a more mature language. This is inarguable.
As for the language itself, there are a few things that C++ does better than D in my opinion.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/ue4ufunction-processevent%E8%BF%94%E5%9B%9E%E5%80%BC%E4%B8%8E%E8%BE%93%E5%87%BA%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96/">
                <h3 class="media-heading">[UE4]UFunction-ProcessEvent返回值与输出参数获取</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">如果不需要返回值也不需要输出参数，那么只需调用 ProcessEvent ：
UFunction* Fun = Actor-&gt;FindFunction(TEXT(&quot;TestFun&quot;)); if(Fun) { Actor-&gt;ProcessEvent(Fun, Buffer); }  获取返回值：
UFunction* Fun = Actor-&gt;FindFunction(TEXT(&quot;TestFun&quot;)); if(Fun) { FFrame frame = FFrame(Actor, Fun, Buffer, NULL, Fun-&gt;Children); uint8* ReturnValueAdress = Buffer + Fun-&gt;ReturnValueOffset; int* intp = (int*)ReturnValueAdress; //hardcoded exemple for a int return Fun-&gt;Invoke(Actor, frame, intp); }  获取输出参数：
if(UFunction* Fun = Actor-&gt;FindFunction(TEXT(&quot;TestFun&quot;))) { if(uint8* Buffer = (uint8*)FMemory_Alloca(Fun-&gt;ParmsSize)) { for (TFieldIterator&lt;UProperty&gt; PropIt(Fun, EFieldIteratorFlags::ExcludeSuper); PropIt; ++PropIt) { UProperty* Property = *PropIt; bool isOut = Property-&gt;HasAnyPropertyFlags(CPF_OutParm); if (!</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/hugo-%E9%9B%86%E6%88%90mathjax/">
                <h3 class="media-heading">hugo-集成MathJax</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">keywords：hugo、MathJax、公式、数学表达式
步骤 1，在theme\layouts\partials\目录下新建一个文件，命名为 mathjax_support.html，内容为：
&lt;script type=&quot;text/javascript&quot; async src=&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML&quot;&gt; &lt;/script&gt; &lt;script type=&quot;text/x-mathjax-config&quot;&gt; MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], displayMath: [['$$','$$'], ['\[','\]']], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'], TeX: { equationNumbers: { autoNumber: &quot;AMS&quot; }, extensions: [&quot;AMSmath.js&quot;, &quot;AMSsymbols.js&quot;] } } }); &lt;/script&gt;  2，在header.html的&lt;/header&gt;之前或者footer.html的&lt;/footer&gt;之前添加：
{{ if .Params.mathjax}}{{ partial &quot;mathjax_support.html&quot; . }}{{ end }}  3，在MD文件的头部追加mathjax : ture：
--- title : &quot;hugo-集成MathJax&quot; date : &quot;2018-06-22T00:51:40+08:00&quot; mathjax : ture ---  如果是新语法，则追加mathjax= [&quot;ture&quot;]：</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/openglglsl-cookbook%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E6%AD%A5%E9%AA%A4%E6%B5%81%E7%A8%8B2018.06%E6%96%B0%E7%89%88/">
                <h3 class="media-heading">[OpenGL]GLSL Cookbook源码编译步骤流程(2018.06新版)</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">去年写过一篇文章，github上的最新代码与这篇文章已不再有效（主要是glm和glfw的配置发生变动）：
http://www.dawnarc.com/2017/09/openglglsl-cookbook%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E6%AD%A5%E9%AA%A4%E6%B5%81%E7%A8%8B/
当前这篇文章针对github的glslcookbook最新代码，重新梳理一次配置流程，保证最新代码能编译工程并跑起来。步骤如下：
1，下载glm源码，并用cmake-gui生成VS工程文件：
https://github.com/g-truc/glm/releases/download/0.9.9.0/glm-0.9.9.0.zip
假设
cmake-gui的source code设置为：
D:/sdk/glm-0.9.9.0
cmake-gui的build binaries设置为：
D:/sdk/glm-0.9.9.0/bin
Configure过程中，会有警告，可以无视，直接Generate：
GLM is a header only library, no need to build it. Set the option GLM_TEST_ENABLE with ON to build and run the test bench  生成完以后，不需要打开VS编译，后面直接使用相关文件即可。
2，下载glfw源码，并用cmake-gui生成VS工程文件。 https://github.com/glfw/glfw/releases/download/3.2.1/glfw-3.2.1.zip
假设
cmake-gui的source code设置为：
D:/sdk/glfw-3.2.1
cmake-gui的build binaries设置为：
D:/sdk/glfw-3.2.1/bin
Configure过程中，会有红色警告，可以无视，直接Generate：
CMake Deprecation Warning at CMakeLists.txt:10 (cmake_policy): The OLD behavior for policy CMP0042 will be removed from a future version of CMake. The cmake-policies(7) manual explains that the OLD behaviors of all policies are deprecated and that a policy should be set to OLD only under specific short-term circumstances.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/git%E8%BF%9C%E7%A8%8B%E6%93%8D%E4%BD%9Cfetchpushstash/">
                <h3 class="media-heading">[git]远程操作：fetch、push、stash</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">相关参考：
https://www.jianshu.com/p/e78b28081a44
https://stackoverflow.com/questions/9237348/what-does-fetch-head-in-git-mean
https://ruby-china.org/topics/4768
git clone git clone支持多种协议，除了HTTP(s)以外，还支持SSH、Git、本地文件协议等，通常来说，Git协议下载速度最快，SSH协议用于需要用户认证的场合。在clone完成之后，Git 会自动为你将此远程仓库命名为origin（origin只相当于一个别名，运行git remote –v或者查看.git/config可以看到origin的含义），并下载其中所有的数据，建立一个指向它的master 分支的指针，我们用(远程仓库名)/(分支名) 这样的形式表示远程分支，所以origin/master指向的是一个remote branch（从那个branch我们clone数据到本地），但你无法在本地更改其数据。同时，Git 会建立一个属于你自己的本地master 分支，它指向的是你刚刚从remote server传到你本地的副本。随着你不断的改动文件，git add, git commit，master的指向会自动移动，你也可以通过merge（fast forward）来移动master的指向。
git clone + 远程仓库项目网址  克隆远程仓库项目到本地仓库，也就是俗称的拉代码，本地仓库生成的项目与远程仓库的项目结构一致。git clone + 远程仓库项目网址 + 本地仓库项目目录：克隆远程仓库项目到本地仓库，本地仓库生成的项目放在第二个参数【本地仓库项目目录】中
git fetch 真正理解 git fetch, git pull，要讲清楚git fetch，git pull,必须要附加讲清楚git remote，git merge 、远程repo， branch 、 commit-id 以及 FETCH_HEAD。
 git remote
首先， git是一个分布式的结构，这意味着本地和远程是一个相对的名称。
本地的repo仓库要与远程的repo配合完成版本对应必须要有 git remote子命令，通过git remote add来添加当前本地长度的远程repo， 有了这个动作本地的repo就知道了当遇到git push 的时候应该往哪里提交代码。
 git branch
其次，git天生就是为了多版本分支管理而创造的，因此分支一说，不得不提， 分支就相当于是为了单独记录软件的某一个发布版本而存在的，既然git是分布式的，便有了本地分支和远程分支一说，git branch 可以查看本地分支， git branch -r 可以用来查看远程分支。 本地分支和远程分支在git push 的时候可以随意指定，交错对应，只要不出现版本从图即可。</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/opengl%E5%B8%B8%E8%A7%81%E7%BC%96%E8%AF%91%E9%94%99%E8%AF%AF/">
                <h3 class="media-heading">[OpenGL]常见编译错误</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">错误1 error C2027: use of undefined type 'glm::tvec4&lt;float,0&gt;'  原因：
只包含了头文件：&lt;glm/detail/type_vec.hpp&gt;
解决办法：
不需要包含&lt;glm/detail/type_vec.hpp&gt;，只需要包含&lt;glm/glm.hpp&gt;。
就投机钻营来说，世故的价值永远是无可比拟的。---《死魂灵》</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/c--how-to-add-constructors-or-destructors-to-an-unnamed-class%E4%B8%BA%E5%8C%BF%E5%90%8D%E7%B1%BB%E6%B7%BB%E5%8A%A0%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8E%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/">
                <h3 class="media-heading">[C&#43;&#43;]How to add constructors or destructors to an unnamed class(为匿名类添加构造函数与析构函数)</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">keywords：匿名类，匿名结构体、构造函数、析构函数、Lambda
为匿名类添加构造函数与析构函数，有两种方式：
 C++98中在匿名类内部加一个命名类 C++11 Lambda语法  C++98 C++98中，可以在匿名类内部放一个命名类(named class )，然后再为命名类添加构造和析构函数，当匿名类构造或析构时，就会去调用命名类的构造函数和析构函数。
#include &lt;iostream&gt; #include &lt;cmath&gt; int main() { struct { struct S { double a; int b; S() : a(sqrt(4)), b(42) { std::cout &lt;&lt; &quot;constructed&quot; &lt;&lt; std::endl; } ~S() { std::cout &lt;&lt; &quot;destructed&quot; &lt;&lt; std::endl; } } s; } instance1, instance2; std::cout &lt;&lt; &quot;body&quot; &lt;&lt; std::endl; }  C++11 Lambda #include &lt;iostream&gt; #include &lt;cmath&gt; int main() { struct { double a { sqrt(4) }; int b { []{ std::cout &lt;&lt; &quot;constructed&quot; &lt;&lt; std::endl; return 42; }() }; } instance1, instance2; }  参考 How to add constructors/destructors to an unnamed class?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/openglglm%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%A7%A3%E9%87%8A%E8%AF%B4%E6%98%8E/">
                <h3 class="media-heading">[OpenGL]GLM常用函数解释说明</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">GLM默认使用右手坐标系，如果要改成默认左手坐标系，使用：
GLM_FORCE_LEFT_HANDED  &lt;glm/trigonometric.hpp&gt; GLM_FUNC_DECL GLM_CONSTEXPR vec&lt; L, T, Q &gt; radians (vec&lt; L, T, Q &gt; const &amp;degrees)  将角度转化为弧度。
&lt;glm/gtx/transform.hpp&gt; GLM_FUNC_DECL mat&lt; 4, 4, T, Q &gt; rotate (T angle, vec&lt; 3, T, Q &gt; const &amp;v)  使用一个用弧度(radians)表示的角度(degrees)，以及一个用3个标量(scalar)表示的坐标(axis)，来构建一个4X4的旋转矩阵(rotate matrix)。
&lt;glm/gtc/matrix_transform.hpp&gt; GLM_FUNC_DECL mat&lt;4, 4, T, Q&gt; lookAt (vec&lt;3, T, Q&gt; const &amp;eye, vec&lt;3, T, Q&gt; const &amp;center, vec&lt;3, T, Q&gt; const &amp;up)  基于默认的偏手坐标系来构建一个给定视图矩阵(view matrix)的视角(look)
GLM_FUNC_DECL mat&lt;4, 4, T, defaultp&gt; perspective (T fovy, T aspect, T near, T far)  为一个对称透视图截锥(symmetric perspective-view frustum)创建矩阵，基于默认的偏手坐标系和默认的近剪裁面距离、远剪裁面距离</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="http://www.dawnarc.com/2018/06/shadingads%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E4%BE%8Bopengl%E5%AE%9E%E7%8E%B0/">
                <h3 class="media-heading">【Shading】ADS光照模型实例(OpenGL实现)</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">keywords：ambient diffuse specular、Phong Shading、Phong reflection model
公式概述 ADS光照模型又称为“冯氏反射模型”(Phong reflection model)，为什么叫冯氏：
裴祥风（Bùi Tường Phong音译, 1942年—1975年），美国电脑CG研究学者，于越南出生。他于1973年在尤他大学取得哲学博士学位，并发明了Phong反射模型及Phong著色法，并广为CG界采用。1975死于白血病。
 ADS光照模型公式缩写：
LightIntensity = Ambient + Diffuse + Specular;  参数说明：
 Ambient 环境光 Diffuse 漫反射 Specular 全反射光 / 镜面光  三个参数拆解如下：
Ambient = La * Ka; Diffuse = Ld * Kd * max( dot(s, n), 0.0 ); Specular = Ls * Ks * pow( max( dot(r, v), 0.0 ), f );  参数说明：
 La 环境光强度(Ambient light intensity) Ka 材质环境光反射率 / 材质环境光反射系数(Ambient reflectivity) Ld 漫射光强度 / 散射光强度(Diffuse light intensity) Kd 材质漫反射率 / 材质漫反射系数(Diffuse reflectivity) s 顶点 / 曲面点 到光源方向的单位向量(Direction from the surface point to the light source) n 顶点 / 曲面点 的法线单位向量(Normal vector at the surface point) Ls 镜面光强度 / 全反射光强度(Specular light intensity) Ks 材质镜面反射率 / 材质镜面反射系数(Specular reflectivity) r 完全反射向量( the vector of perfect reflection) v 顶点 / 曲面点 到摄像机方向的向量( the vector towards the viewer) f 镜面高光(specular highlights)，值范围在1到200之间，值越小，镜面亮点越大    光源出射强度 / 出射光强度(Intensity of the outgoing light ) I 的完整计算公式如下： $$ I = La \cdot Ka+Ld \cdot Kd \cdot \left(\vec{s} \cdot \vec{n}\right)+Ld \cdot Kd \cdot \left(\vec{r} \cdot \vec{v}\right)^f $$</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         401 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('http://www.dawnarc.com/images/cover-v1.2.0.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="http://www.dawnarc.com/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'http:\/\/www.dawnarc.com\/2017\/01\/shadingopengl%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\/';
          
            this.page.identifier = '\/2017\/01\/shadingopengl%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'dawnarc';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

