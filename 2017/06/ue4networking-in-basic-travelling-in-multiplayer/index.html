<!DOCTYPE html>
<html lang="en">
  <head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4843403245883139"
     crossorigin="anonymous"></script>

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.145.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Wang Aiguo">
<meta name="keywords" content="UE4, Networking">
<meta name="description" content="Keywords: UE4, Networking, Dedicated Server,ClientTravel, ServerTravel, UEngine::Browse">


<meta property="og:description" content="Keywords: UE4, Networking, Dedicated Server,ClientTravel, ServerTravel, UEngine::Browse">
<meta property="og:type" content="article">
<meta property="og:title" content="[UE4]Networking in Basic - Travelling in Multiplayer">
<meta name="twitter:title" content="[UE4]Networking in Basic - Travelling in Multiplayer">
<meta property="og:url" content="https://dawnarc.com/2017/06/ue4networking-in-basic-travelling-in-multiplayer/">
<meta property="twitter:url" content="https://dawnarc.com/2017/06/ue4networking-in-basic-travelling-in-multiplayer/">
<meta property="og:site_name" content="玄冬Wong">
<meta property="og:description" content="Keywords: UE4, Networking, Dedicated Server,ClientTravel, ServerTravel, UEngine::Browse">
<meta name="twitter:description" content="Keywords: UE4, Networking, Dedicated Server,ClientTravel, ServerTravel, UEngine::Browse">
<meta property="og:locale" content="en">

  
    <meta property="article:published_time" content="2017-06-01T11:05:40">
  
  
    <meta property="article:modified_time" content="2024-09-22T13:28:59">
  
  
  
    
      <meta property="article:section" content="UnrealEngine4">
    
  
  
    
      <meta property="article:tag" content="UE4">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://dawnarc.com/thumbnail/beijing/thumbnail-beijing-010.jpg">
  <meta property="twitter:image" content="https://dawnarc.com/thumbnail/beijing/thumbnail-beijing-010.jpg">






    <title>[UE4]Networking in Basic - Travelling in Multiplayer</title>

    <link rel="icon" href="https://dawnarc.com/favicon.png">
    

    <link rel="canonical" href="https://dawnarc.com/2017/06/ue4networking-in-basic-travelling-in-multiplayer/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://dawnarc.com/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet" href="https://dawnarc.com/cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/paraiso-light.min.css">
      
    

    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4P9RSN4PXQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4P9RSN4PXQ');
</script>
  
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://dawnarc.com/">玄冬Wong</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://dawnarc.com/#about">
    
    
    
      
    
    </a>
    
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    <div class="sidebar-profile">
        <a href="https://dawnarc.com/#about">
          <img class="sidebar-profile-picture" src="https://dawnarc.com/avatar.jpg" alt="" />
        </a>
        <h4 class="sidebar-profile-name">Wang Aiguo</h4>
        <h5 class="sidebar-profile-bio">山河固，九边殊，万里川原，龙旗指处。</h5>
      </div>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/1645289/protoss" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.facebook.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.instagram.com/dawn_arc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-instagram"></i>
      
      <span class="sidebar-button-desc">Instagram</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/dawnarc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.pinterest.com/wangaiguo/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-pinterest"></i>
      
      <span class="sidebar-button-desc">Pinterest</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://steamcommunity.com/id/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-steam"></i>
      
      <span class="sidebar-button-desc">Steam</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/dawn_arc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://weibo.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
      
      <span class="sidebar-button-desc">Weibo</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      [UE4]Networking in Basic - Travelling in Multiplayer
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-06-01T11:05:40&#43;08:00">
        
  
  
  
  
    Thursday, 11:05, Jun 1, 2017
  

      </time>
    
    
  
  
    <span></span>
    
      <a class="category-link" href="https://dawnarc.com/categories/unrealengine4">UnrealEngine4</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
			<amp-auto-ads type="adsense"
					data-ad-client="ca-pub-4843403245883139">
			</amp-auto-ads>
            <div class="main-content-wrap">
                <ins class="adsbygoogle"
                     style="display:block;height:120px"
                     data-ad-client="ca-pub-4843403245883139"
                     data-ad-slot="2321022024"
                     data-ad-format="fluid"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
              <p>Keywords: UE4, Networking, Dedicated Server,ClientTravel, ServerTravel, UEngine::Browse</p>
<h3 id="notices">Notices</h3>
<h5 id="difference-between-servertravel-and-clienttravel">Difference between ServerTravel and ClientTravel</h5>
<ul>
<li>ServerTravel also informs the clients to move along with the server.</li>
<li>ClientTravel will be called locally for the client to load a new map. or connect to ip.</li>
<li>Browse can load local map via LoadMap ( not for multiplayer ) but there are more things happening in this method. I also want to know more about what it does and what it should be used for.</li>
<li>LoadMap should also load a map for a local client</li>
</ul>
<p>Browse, LoadMap, ServerTravel and ClientTravel?<br>
<a href="https://answers.unrealengine.com/questions/122565/browse-servertravel-and-clienttravel.html">https://answers.unrealengine.com/questions/122565/browse-servertravel-and-clienttravel.html</a></p>
<p>What&rsquo;s the different between absolute travel and relative travel?<br>
<a href="https://answers.unrealengine.com/questions/101284/what-the-different-between-absolute-travel-and-rel.html">https://answers.unrealengine.com/questions/101284/what-the-different-between-absolute-travel-and-rel.html</a></p>
<p>What is the difference between ServerTravel and OpenLevel?<br>
<a href="https://answers.unrealengine.com/questions/55477/the-difference-of-the-two-functions.html">https://answers.unrealengine.com/questions/55477/the-difference-of-the-two-functions.html</a></p>
<p>PlayerController-&gt;ClientTravel() (Connect to remote server)<br>
<a href="https://answers.unrealengine.com/questions/29017/gamemode-multiplayer-c.html">https://answers.unrealengine.com/questions/29017/gamemode-multiplayer-c.html</a></p>
<p>Seamless and non-seamless travel<br>
<a href="https://docs.unrealengine.com/latest/INT/Gameplay/Networking/Travelling">https://docs.unrealengine.com/latest/INT/Gameplay/Networking/Travelling</a></p>
<h3 id="cases">Cases</h3>
<h5 id="how-to-pass-arguments-from-client-to-server">How to pass arguments from Client to Server</h5>
<p>When execute <code>PlayerController-&gt;ClientTravel</code>, default URL is like this:</p>
<pre><code>FString Address = TEXT(&quot;127.0.0.1:7777&quot;);
</code></pre>
<p>If want to pass arguments to Server when logining, format URL like this:</p>
<pre><code>FString Address = FString::Printf(TEXT(&quot;127.0.0.1:7777?Param1=%s?Param2=%s&quot;), *Param1, *Param2);
</code></pre>
<h5 id="how-to-parse-arguments-sent-by-client-on-server">How to parse arguments sent by Client on Server</h5>
<p>Overrice function <code>InitNewPlayer()</code> in <code>GameMode</code>, then parse arguments like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span>FString AMyGameMode<span style="color:#f92672">::</span>InitNewPlayer(APlayerController<span style="color:#f92672">*</span> NewPlayerController, <span style="color:#66d9ef">const</span> FUniqueNetIdRepl<span style="color:#f92672">&amp;</span> UniqueId, <span style="color:#66d9ef">const</span> FString<span style="color:#f92672">&amp;</span> Options, <span style="color:#66d9ef">const</span> FString<span style="color:#f92672">&amp;</span> Portal <span style="color:#f92672">=</span> TEXT(<span style="color:#e6db74">&#34;&#34;</span>))
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    FString Param1 <span style="color:#f92672">=</span> UGameplayStatics<span style="color:#f92672">::</span>ParseOption(Options, TEXT(<span style="color:#e6db74">&#34;Param1&#34;</span>));
</span></span><span style="display:flex;"><span>    FString Param2 <span style="color:#f92672">=</span> UGameplayStatics<span style="color:#f92672">::</span>ParseOption(Options, TEXT(<span style="color:#e6db74">&#34;Param2&#34;</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Official Doc: Passing Arguments To Server During Connection<br>
<a href="https://wiki.unrealengine.com/Passing_Arguments_To_Server_During_Connection">https://wiki.unrealengine.com/Passing_Arguments_To_Server_During_Connection</a></p>
<h5 id="how-does-server-informs-clients-which-are-connected-to-server-to-travel-map">How does Server informs Clients which are connected to Server to travel map</h5>
<p>Execute <code>ClientTravel</code> on Server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> AMyGameModeBase<span style="color:#f92672">::</span>PostLogin(APlayerController<span style="color:#f92672">*</span> NewPlayer)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    Super<span style="color:#f92672">::</span>PostLogin(NewPlayer);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    FString URL <span style="color:#f92672">=</span> TEXT(<span style="color:#e6db74">&#34;/Game/Maps/TestMap&#34;</span>);
</span></span><span style="display:flex;"><span>    NewPlayer<span style="color:#f92672">-&gt;</span>ClientTravel(URL, TRAVEL_Absolute);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="alert warning ">
  <p>This way works right for travelling to new map, but Client would also disconnect to Server. It means that the <code>NetMode</code> of all Actors in Client would be set as <code>NM_Standalone</code>.</p>
</div>
<h5 id="how-to-use-servertravel">How to use ServerTravel</h5>
<div class="alert success ">
  <p>A common use case is starting a server in a lobby level. Clients connect to this lobby level and choose loadout and character, for example. When ready, the server triggers a ServerTravel, which transitions all clients into the main game level.</p>
</div>
<p>When ServerTravel is triggered, the server tells all clients to begin to ClientTravel to the map specified. If the ServerTravel is seamless then the client maintains its connection to the server. If it’s not seamless then all the clients disconnect from the server and reconnect once they have loaded the map. Internally, the server does a similar process: it loads in the new level, usually a game world for all the clients to play on, and begins accepting player spawn requests once ready.</p>
<p>Reference: Map travel<br>
<a href="https://docs.improbable.io/unreal/alpha/content/map-travel#in-native-unreal-1">https://docs.improbable.io/unreal/alpha/content/map-travel#in-native-unreal-1</a></p>
<h5 id="enabling-seamless-travel">Enabling Seamless Travel</h5>
<p>To enable seamless travel, you need to setup a transition map. This is configured through the UGameMapsSettings::TransitionMap property. By default this property is empty, and if your game leaves this property empty, an empty map will be created for the transition map.</p>
<p>The reason the transition map exists, is that there must always be a world loaded (which holds the map), so we can&rsquo;t free the old map before loading the new one. Since maps can be very large, it would be a bad idea to have the old and new map in memory at the same time, so this is where the transition map comes in.</p>
<p>So now we can travel from the current map to the transition map, and then from there we can travel to the final map. Since the transition map is very small, it doesn&rsquo;t add much extra overhead while it overlaps the current and final map.</p>
<p>Once you have the transition map setup, you set <code>AGameModeBase::bUseSeamlessTravel</code> to true, and from there seamless travel should work!</p>
<p>Origin:<br>
<a href="https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Networking/Travelling/">https://docs.unrealengine.com/4.27/en-US/InteractiveExperiences/Networking/Travelling/</a></p>
<h3 id="api-related">API Related</h3>
<h5 id="clienttravel">ClientTravel</h5>
<p>See the usage of <code>APlayerController-&gt;ClientTravel()</code> in offical example <a href="https://www.unrealengine.com/marketplace/en-US/product/shooter-game">Shooter Game</a>.</p>
<h5 id="seamless-travel">Seamless travel</h5>
<p>After seamless travel <code>AGameModeBase::GenericPlayerInitialization(AController* Controller)</code> and <code>AGameModeBase::HandleStartingNewPlayer()</code>, Gets called for the client.</p>
<p>Related<br>
<a href="https://answers.unrealengine.com/questions/251940/post-login-event-not-firing-on-active-clients-afte.html">https://answers.unrealengine.com/questions/251940/post-login-event-not-firing-on-active-clients-afte.html</a></p>
<h5 id="travelling-api-in-gamemode">Travelling API in GameMode</h5>
<p>ClientTravel:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span>APlayerController<span style="color:#f92672">*</span> AGameModeBase<span style="color:#f92672">::</span>ProcessClientTravel(FString<span style="color:#f92672">&amp;</span> FURL, FGuid NextMapGuid, <span style="color:#66d9ef">bool</span> bSeamless, <span style="color:#66d9ef">bool</span> bAbsolute)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// We call PreClientTravel directly on any local PlayerPawns (ie listen server)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    APlayerController<span style="color:#f92672">*</span> LocalPlayerController <span style="color:#f92672">=</span> <span style="color:#66d9ef">nullptr</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (FConstPlayerControllerIterator Iterator <span style="color:#f92672">=</span> GetWorld()<span style="color:#f92672">-&gt;</span>GetPlayerControllerIterator(); Iterator; <span style="color:#f92672">++</span>Iterator)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (APlayerController<span style="color:#f92672">*</span> PlayerController <span style="color:#f92672">=</span> Iterator<span style="color:#f92672">-&gt;</span>Get())
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (Cast<span style="color:#f92672">&lt;</span>UNetConnection<span style="color:#f92672">&gt;</span>(PlayerController<span style="color:#f92672">-&gt;</span>Player) <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nullptr</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Remote player
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                PlayerController<span style="color:#f92672">-&gt;</span>ClientTravel(FURL, TRAVEL_Relative, bSeamless, NextMapGuid);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Local player
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                LocalPlayerController <span style="color:#f92672">=</span> PlayerController;
</span></span><span style="display:flex;"><span>                PlayerController<span style="color:#f92672">-&gt;</span>PreClientTravel(FURL, bAbsolute <span style="color:#f92672">?</span> TRAVEL_Absolute : TRAVEL_Relative, bSeamless);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> LocalPlayerController;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ServerTravel:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> AGameModeBase<span style="color:#f92672">::</span>ProcessServerTravel(<span style="color:#66d9ef">const</span> FString<span style="color:#f92672">&amp;</span> URL, <span style="color:#66d9ef">bool</span> bAbsolute)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#75715e">#if WITH_SERVER_CODE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    StartToLeaveMap();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Force an old style load screen if the server has been up for a long time so that TimeSeconds doesn&#39;t overflow and break everything
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">bool</span> bSeamless <span style="color:#f92672">=</span> (bUseSeamlessTravel <span style="color:#f92672">&amp;&amp;</span> GetWorld()<span style="color:#f92672">-&gt;</span>TimeSeconds <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">172800.0f</span>); <span style="color:#75715e">// 172800 seconds == 48 hours
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    FString NextMap;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (URL.ToUpper().Contains(TEXT(<span style="color:#e6db74">&#34;?RESTART&#34;</span>)))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        NextMap <span style="color:#f92672">=</span> UWorld<span style="color:#f92672">::</span>RemovePIEPrefix(GetOutermost()<span style="color:#f92672">-&gt;</span>GetName());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        int32 OptionStart <span style="color:#f92672">=</span> URL.Find(TEXT(<span style="color:#e6db74">&#34;?&#34;</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (OptionStart <span style="color:#f92672">==</span> INDEX_NONE)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            NextMap <span style="color:#f92672">=</span> URL;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            NextMap <span style="color:#f92672">=</span> URL.Left(OptionStart);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    FGuid NextMapGuid <span style="color:#f92672">=</span> UEngine<span style="color:#f92672">::</span>GetPackageGuid(FName(<span style="color:#f92672">*</span>NextMap), GetWorld()<span style="color:#f92672">-&gt;</span>IsPlayInEditor());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Notify clients we&#39;re switching level and give them time to receive.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    FString URLMod <span style="color:#f92672">=</span> URL;
</span></span><span style="display:flex;"><span>    APlayerController<span style="color:#f92672">*</span> LocalPlayer <span style="color:#f92672">=</span> ProcessClientTravel(URLMod, NextMapGuid, bSeamless, bAbsolute);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UE_LOG(LogGameMode, Log, TEXT(<span style="color:#e6db74">&#34;ProcessServerTravel: %s&#34;</span>), <span style="color:#f92672">*</span>URL);
</span></span><span style="display:flex;"><span>    UWorld<span style="color:#f92672">*</span> World <span style="color:#f92672">=</span> GetWorld();
</span></span><span style="display:flex;"><span>    check(World);
</span></span><span style="display:flex;"><span>    World<span style="color:#f92672">-&gt;</span>NextURL <span style="color:#f92672">=</span> URL;
</span></span><span style="display:flex;"><span>    ENetMode NetMode <span style="color:#f92672">=</span> GetNetMode();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (bSeamless)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        World<span style="color:#f92672">-&gt;</span>SeamlessTravel(World<span style="color:#f92672">-&gt;</span>NextURL, bAbsolute);
</span></span><span style="display:flex;"><span>        World<span style="color:#f92672">-&gt;</span>NextURL <span style="color:#f92672">=</span> TEXT(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Switch immediately if not networking.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (NetMode <span style="color:#f92672">!=</span> NM_DedicatedServer <span style="color:#f92672">&amp;&amp;</span> NetMode <span style="color:#f92672">!=</span> NM_ListenServer)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        World<span style="color:#f92672">-&gt;</span>NextSwitchCountdown <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0f</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif </span><span style="color:#75715e">// WITH_SERVER_CODE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="reference">Reference</h3>
<h5 id="official-docs">Official Docs</h5>
<p>Travelling in Multiplayer<br>
<a href="https://docs.unrealengine.com/en-US/Gameplay/Networking/Travelling/index.html">https://docs.unrealengine.com/en-US/Gameplay/Networking/Travelling/index.html</a></p>
<hr>
<p><code>山舞银蛇，原驰蜡象，欲与天公试比高。须晴日，看红装素裹，分外妖娆。----毛泽东《沁园春·雪》</code></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small"></span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://dawnarc.com/tags/ue4/">UE4</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2017/06/ue4%E8%BD%AC%E8%BD%BDuengine-browse%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/" data-tooltip="[UE4]转载：UEngine Browse()执行流程">
              
                  <i class="fa fa-angle-left"></i>
                  NEXT
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2017/06/ue4c-%E8%8E%B7%E5%8F%96%E6%B8%B8%E6%88%8F%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E5%92%8C%E7%AB%AF%E5%8F%A3/" data-tooltip="[UE4]C&#43;&#43;获取游戏当前登录的服务器IP和端口">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  PREVIOUS
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            <script src="https://utteranc.es/client.js"
  repo="dawnarc/dawnarc.github.io"
  issue-term="pathname"
  label="Comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2025 Wang Aiguo. Powered by <A href="https://gohugo.io/"> Hugo</A> | Theme <A href="https://github.com/kakawait/hugo-tranquilpeak-theme/">Tranquilpeak</A>.
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2017/06/ue4%E8%BD%AC%E8%BD%BDuengine-browse%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B/" data-tooltip="[UE4]转载：UEngine Browse()执行流程">
              
                  <i class="fa fa-angle-left"></i>
                  NEXT
                  <span class="hide-xs hide-sm text-small icon-ml"></span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2017/06/ue4c-%E8%8E%B7%E5%8F%96%E6%B8%B8%E6%88%8F%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E5%92%8C%E7%AB%AF%E5%8F%A3/" data-tooltip="[UE4]C&#43;&#43;获取游戏当前登录的服务器IP和端口">
              
                  <span class="hide-xs hide-sm text-small icon-mr"></span>
                  PREVIOUS
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
    
      <img id="about-card-picture" src=https://dawnarc.com/avatar.jpg alt="" />
    
    
    <h4 id="about-card-name">Wang Aiguo</h4>
    
      <div id="about-card-bio">山河固，九边殊，万里川原，龙旗指处。</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Yichang, Hubei
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('https://dawnarc.com/images/cover-v1.2.0.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

	<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/school-book.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://dawnarc.com/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
document.addEventListener('DOMContentLoaded', (event) => {
  document.querySelectorAll('pre code').forEach((el) => {
    hljs.highlightElement(el);
  });
});
</script>






    
  </body>
</html>

