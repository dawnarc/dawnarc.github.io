<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4843403245883139"
     crossorigin="anonymous"></script>

<script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.88.1 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Neil Wang">
<meta name="keywords" content="UE4, Networking">
<meta name="description" content="Keywords: UE4, Networking">


<meta property="og:description" content="Keywords: UE4, Networking">
<meta property="og:type" content="article">
<meta property="og:title" content="[UE4]Networking in Advanced - Engine Source Analysis &amp; High-Level Cases">
<meta name="twitter:title" content="[UE4]Networking in Advanced - Engine Source Analysis &amp; High-Level Cases">
<meta property="og:url" content="https://dawnarc.com/2019/06/ue4networking-in-advanced-engine-source-analysis-high-level-cases/">
<meta property="twitter:url" content="https://dawnarc.com/2019/06/ue4networking-in-advanced-engine-source-analysis-high-level-cases/">
<meta property="og:site_name" content="玄冬Wong">
<meta property="og:description" content="Keywords: UE4, Networking">
<meta name="twitter:description" content="Keywords: UE4, Networking">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2019-06-21T17:00:02">
  
  
    <meta property="article:modified_time" content="2019-06-21T17:00:02">
  
  
  
    
      <meta property="article:section" content="UnrealEngine4">
    
  
  
    
      <meta property="article:tag" content="UE4">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@dawn_arc">


  <meta name="twitter:creator" content="@dawn_arc">






  <meta property="og:image" content="https://dawnarc.com/thumbnail/thumbnail-japen-001.jpg">
  <meta property="twitter:image" content="https://dawnarc.com/thumbnail/thumbnail-japen-001.jpg">





  <meta property="og:image" content="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=640">


    <title>[UE4]Networking in Advanced - Engine Source Analysis &amp; High-Level Cases</title>

    <link rel="icon" href="https://dawnarc.com/favicon.png">
    

    

    <link rel="canonical" href="https://dawnarc.com/2019/06/ue4networking-in-advanced-engine-source-analysis-high-level-cases/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://dawnarc.com/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/solarized-light.min.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-78064851-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://dawnarc.com/">玄冬Wong</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://dawnarc.com/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=90" alt="Author&#39;s picture" />
      
    
    </a>
    
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://dawnarc.com/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Neil Wang</h4>
        
          <h5 class="sidebar-profile-bio">久长唯有品格</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://dawnarc.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/1645289/protoss" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.facebook.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-facebook"></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.instagram.com/dawn_arc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-instagram"></i>
      
      <span class="sidebar-button-desc">Instagram</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/dawnarc/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.pinterest.com/wangaiguo/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-pinterest"></i>
      
      <span class="sidebar-button-desc">Pinterest</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://steamcommunity.com/id/dawnarc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-steam"></i>
      
      <span class="sidebar-button-desc">Steam</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/dawn_arc" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://weibo.com/koanland" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
      
      <span class="sidebar-button-desc">Weibo</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      [UE4]Networking in Advanced - Engine Source Analysis &amp; High-Level Cases
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2019-06-21T17:00:02&#43;08:00">
        
  
  
  
  
    Friday, 17:00, Jun 21, 2019
  

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://dawnarc.com/categories/unrealengine4">UnrealEngine4</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
			<amp-auto-ads type="adsense"
					data-ad-client="ca-pub-4843403245883139">
			</amp-auto-ads>
            <div class="main-content-wrap">
                <ins class="adsbygoogle"
                     style="display:block;height:120px"
                     data-ad-client="ca-pub-4843403245883139"
                     data-ad-slot="2321022024"
                     data-ad-format="fluid"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
              <p>Keywords: UE4, Networking</p>
<h3 id="replication-cases">Replication Cases</h3>
<h5 id="disconnect-actors-replication-at-run-time">Disconnect Actor&rsquo;s replication at Run-time</h5>
<p>Case:<br>
A Character is replicated at first, then we want to disable replication when it dies.<br>
E.g. Ragdoll, if we continue to keep replicating when character dies, it would increase overhead on server and server not care the result of Ragdoll, Ragdoll is just effect on client, so we need disconnect replication before perform Ragdoll computing.</p>
<p>Solution:<br>
Execute <code>AActor::ForceNetUpdate()</code> to replicate current data to client before Ragdoll computing fired on server, then execute <code>AActor::TearOff</code> on server, from now on, Actor would not be replicaed forever.<br>
<code>AActor::TornOff()</code> would be fired on client after executing <code>AActor::TearOff</code> on server, it means that Actor can be modified arbitrarily and it would not be corrected by server.</p>
<h5 id="replication-of-bullet-path-in-shooting-game">Replication of bullet path in shooting game</h5>
<p>Suggestion:</p>
<ol>
<li><code>bReplicateMovement = true;</code> in constructor of BulletActor;</li>
<li><code>ProjectileMovement-&gt;InitialSpeed = 0.f;</code> and <code>ProjectileMovement-&gt;MaxSpeed = 0.f;</code> in constructor of BulletActor;</li>
<li>Set real time speed of BulletActor in Server.</li>
</ol>
<div class="alert warning ">
  <p>If you set a large value for <code>ProjectileMovement-&gt;InitialSpeed</code> in bullet constructor, and then set <code>Velocity</code> in server, bullet path would jitter at the beginning.</p>
</div>
<h5 id="lognet-uchannelreceivedsequencedbunch-bunchbclose">LogNet: UChannel::ReceivedSequencedBunch: Bunch.bClose</h5>
<p>Error of dedicated server:</p>
<pre><code>LogNet: UChannel::ReceivedSequencedBunch: Bunch.bClose == true. ChIndex == 0. Calling ConditionalCleanUp.
LogNet: UChannel::CleanUp: ChIndex == 0. Closing connection. [UChannel] ChIndex: 0, Closing: 0 [UNetConnection] RemoteAddr: 10.0.51.19:58395, Name: IpConnection_2147456657, Driver: GameNetDriver IpNetDriver_2147482490, IsServer: YES, PC: BP_PlayerController_C_2147456649, Owner: BP_PlayerController_C_2147456649, UniqueId: NULL:63YQHN7321-E05ECCF9407D3A5479CE6C8A16AA9F77
LogNet: UNetConnection::Close: [UNetConnection] RemoteAddr: 10.0.51.19:58395, Name: IpConnection_2147456657, Driver: GameNetDriver IpNetDriver_2147482490, IsServer: YES, PC: BP_PlayerController_C_2147456649, Owner: BP_PlayerController_C_2147456649, UniqueId: NULL:63YQHN7321-E05ECCF9407D3A5479CE6C8A16AA9F77, Channels: 12, Time: 2021.11.10-09.03.02
LogNet: UChannel::Close: Sending CloseBunch. ChIndex == 0. Name: [UChannel] ChIndex: 0, Closing: 0 [UNetConnection] RemoteAddr: 10.0.51.19:58395, Name: IpConnection_2147456657, Driver: GameNetDriver IpNetDriver_2147482490, IsServer: YES, PC: BP_PlayerController_C_2147456649, Owner: BP_PlayerController_C_2147456649, UniqueId: NULL:63YQHN7321-E05ECCF9407D3A5479CE6C8A16AA9F77
</code></pre>
<p>Caused by:<br>
Client initiate to disconnect from server.</p>
<h3 id="ue4-networking-documents">UE4 Networking Documents</h3>
<h5 id="online-beacons-docs">Online Beacons Docs</h5>
<p>Online Beacons are a special type of Actor that provide a lightweight way to contact a server and interact with it (via RPCs) without committing to a normal game connection. While the built-in classes can be used as they are in some cases, they are intended to be extended into custom classes that perform project-specific interactions, logic, and information requests.</p>
<p>Docs: Online Beacons<br>
<a href="https://docs.unrealengine.com/en-US/Gameplay/Networking/OnlineBeacons/index.html">https://docs.unrealengine.com/en-US/Gameplay/Networking/OnlineBeacons/index.html</a></p>
<div class="alert success ">
  <p>Online Beacons Usage:<br>
e.g. If there&rsquo;s a requirement that make a decision to tell Client which Server to login, Client need to know the current player count of peer Server, now you can use Online Beacon to connect to Server before Replication connection created.</p>
</div>
<h5 id="what-are-online-beacons-and-how-do-they-work">What are &ldquo;online beacons&rdquo; and how do they work?</h5>
<p>The idea behind beacons was to provide a lightweight way to contact a server before actually connecting &ldquo;for real&rdquo;.</p>
<p>Ideally you make a connection, send an RPC, get a response, and disconnect. You can ask things like &ldquo;who is in the game&rdquo; or &ldquo;please make room for me, I&rsquo;m about to join&rdquo;. Traditionally, connecting to a server involved a full map load which can be frustrating to users if they do all that work only to be denied entry to an almost full game because someone got into the game first. Now you can make contact while still in the main menu, for example, and test multiple servers to pick the best one before joining. Or to inquire about information about a game in progress to &ldquo;spectate&rdquo; without being actually connected with an APlayerController and all that entails.</p>
<p>Gears 3 used beacons to reserve space in game. That way we could test many servers for space and travel to only one, knowing that you were definitely going to get into the game. It avoided contention when thousands of users all received the same 20-50 search results but only 10 could join per match. <span class="highlight-text green">However, in UE3, this was TCP/IP and the protocol had to be implemented manually not using any reflection by UObject.</span></p>
<p>In UE4, we decided that our already existing network code was so robust and powerful, why reinvent the wheel? So I made the AOnlineBeacon class to leverage all the RPC and replication power of AActor.</p>
<p>Traditionally, actor replication and spawning has always been server initiated, meaning that you had to connect before you got a copy of an actor that the server also knew about. I wanted clients to be able to create an actor that would initiate contact with the server and fire a delegate when a connection has been made so that higher level code could make an RPC. Otherwise you&rsquo;d need to make a connection with the server, wait for the server to send you an actor you could RPC with, then switch to that. Unwieldy in my opinion.</p>
<p>Origin:<br>
<a href="https://answers.unrealengine.com/questions/467973/what-are-online-beacons-and-how-do-they-work.html">https://answers.unrealengine.com/questions/467973/what-are-online-beacons-and-how-do-they-work.html</a></p>
<h5 id="unreal-engine-4-network-compendium">Unreal Engine 4 Network Compendium</h5>
<p><code>Unreal Engine 4 Network Compendium</code> Made by: Cedric &lsquo;eXi&rsquo; Neukirchen<br>
<a href="http://cedric-neukirchen.net/Downloads/Compendium/UE4_Network_Compendium_by_Cedric_eXi_Neukirchen.pdf">http://cedric-neukirchen.net/Downloads/Compendium/UE4_Network_Compendium_by_Cedric_eXi_Neukirchen.pdf</a></p>
<h5 id="custom-serialization-send-streaming-message--bunch-replication">Custom Serialization (Send streaming message / bunch replication)</h5>
<p>Custom Struct Serialization for Networking in Unreal Engine<br>
<a href="http://www.aclockworkberry.com/custom-struct-serialization-for-networking-in-unreal-engine/">http://www.aclockworkberry.com/custom-struct-serialization-for-networking-in-unreal-engine/</a></p>
<h3 id="engine-source-analysis-for-networking">Engine Source Analysis for Networking</h3>
<h5 id="properties-used-for-replication-in-common">Properties used for Replication in Common</h5>
<pre><code>/** Square of the max distance from the client's viewpoint that this actor is relevant and will be replicated. */
UPROPERTY(BlueprintReadOnly, EditDefaultsOnly, Category=Replication)
float NetCullDistanceSquared;   

/** Internal - used by UNetDriver */
UPROPERTY(Transient)
int32 NetTag;

/** How often (per second) this actor will be considered for replication, used to determine NetUpdateTime */
UPROPERTY(Category=Replication, EditDefaultsOnly, BlueprintReadWrite)
float NetUpdateFrequency;

/** Used to determine what rate to throttle down to when replicated properties are changing infrequently */
UPROPERTY(Category=Replication, EditDefaultsOnly, BlueprintReadWrite)
float MinNetUpdateFrequency;

/** Priority for this actor when checking for replication in a low bandwidth or saturated situation, higher priority means it is more likely to replicate */
UPROPERTY(Category=Replication, EditDefaultsOnly, BlueprintReadWrite)
float NetPriority;
</code></pre>
<h5 id="how-does-engine-check-if-actor-is-relevant-to-connection">How does engine check if Actor is relevant to connection</h5>
<p>Critical Code:<br>
Engine\Source\Runtime\Engine\Private\ActorReplication.cpp</p>
<pre><code>bool AActor::IsNetRelevantFor(const AActor* RealViewer, const AActor* ViewTarget, const FVector&amp; SrcLocation) const
{
	if (bAlwaysRelevant || IsOwnedBy(ViewTarget) || IsOwnedBy(RealViewer) || this == ViewTarget || ViewTarget == Instigator)
	{
        return true;
	}
	else if ( bNetUseOwnerRelevancy &amp;&amp; Owner)
	{
        return Owner-&gt;IsNetRelevantFor(RealViewer, ViewTarget, SrcLocation);
	}
	else if ( bOnlyRelevantToOwner )
	{
        return false;
	}
	else if ( RootComponent &amp;&amp; RootComponent-&gt;GetAttachParent() &amp;&amp; RootComponent-&gt;GetAttachParent()-&gt;GetOwner() &amp;&amp; (Cast&lt;USkeletalMeshComponent&gt;(RootComponent-&gt;GetAttachParent()) || (RootComponent-&gt;GetAttachParent()-&gt;GetOwner() == Owner)) )
	{
        return RootComponent-&gt;GetAttachParent()-&gt;GetOwner()-&gt;IsNetRelevantFor(RealViewer, ViewTarget, SrcLocation);
	}
	else if( bHidden &amp;&amp; (!RootComponent || !RootComponent-&gt;IsCollisionEnabled()) )
	{
        return false;
	}

	if (!RootComponent)
	{
        UE_LOG(LogNet, Warning, TEXT(&quot;Actor %s / %s has no root component in AActor::IsNetRelevantFor. (Make bAlwaysRelevant=true?)&quot;), *GetClass()-&gt;GetName(), *GetName() );
        return false;
	}

	return !GetDefault&lt;AGameNetworkManager&gt;()-&gt;bUseDistanceBasedRelevancy ||
            IsWithinNetRelevancyDistance(SrcLocation);
}
</code></pre>
<p>Call Stack:</p>
<pre><code>UE4Editor-Engine.dll!AActor::IsNetRelevantFor(const AActor * RealViewer, const AActor * ViewTarget, const FVector &amp; SrcLocation) Line 320	C++
[Inline Frame] UE4Editor-Engine.dll!IsActorRelevantToConnection(const AActor *) Line 3661	C++
UE4Editor-Engine.dll!UNetDriver::ServerReplicateActors_PrioritizeActors(UNetConnection * Connection, const TArray&lt;FNetViewer,FDefaultAllocator&gt; &amp; ConnectionViewers, const TArray&lt;FNetworkObjectInfo *,FDefaultAllocator&gt; ConsiderList, const bool bCPUSaturated, FActorPriority * &amp; OutPriorityList, FActorPriority * * &amp; OutPriorityActors) Line 3780	C++
UE4Editor-Engine.dll!UNetDriver::ServerReplicateActors(float DeltaSeconds) Line 4359	C++
UE4Editor-Engine.dll!UNetDriver::TickFlush(float DeltaSeconds) Line 506	C++
[Inline Frame] UE4Editor-Engine.dll!TMemberFunctionCaller&lt;UNetDriver,void (__cdecl UNetDriver::*)(float)&gt;::operator()(float &amp;) Line 156	C++
[Inline Frame] UE4Editor-Engine.dll!UE4Tuple_Private::TTupleImpl&lt;TIntegerSequence&lt;unsigned int&gt; &gt;::ApplyAfter(TMemberFunctionCaller&lt;UNetDriver,void (__cdecl UNetDriver::*)(float)&gt; &amp;&amp;) Line 498	C++
[Inline Frame] UE4Editor-Engine.dll!TBaseUObjectMethodDelegateInstance&lt;0,UNetDriver,TTypeWrapper&lt;void&gt; __cdecl(float)&gt;::Execute(float) Line 617	C++
UE4Editor-Engine.dll!TBaseUObjectMethodDelegateInstance&lt;0,UNetDriver,void __cdecl(float)&gt;::ExecuteIfSafe(float &lt;Params_0&gt;) Line 679	C++
UE4Editor-Engine.dll!TBaseMulticastDelegate&lt;void,float&gt;::Broadcast(float &lt;Params_0&gt;) Line 977	C++
UE4Editor-Engine.dll!UWorld::Tick(ELevelTick TickType, float DeltaSeconds) Line 1720	C++
UE4Editor-UnrealEd.dll!UEditorEngine::Tick(float DeltaSeconds, bool bIdleMode) Line 1618	C++
UE4Editor-UnrealEd.dll!UUnrealEdEngine::Tick(float DeltaSeconds, bool bIdleMode) Line 403	C++
UE4Editor-Win64-DebugGame.exe!FEngineLoop::Tick() Line 3967	C++
[Inline Frame] UE4Editor-Win64-DebugGame.exe!EngineTick() Line 62	C++
UE4Editor-Win64-DebugGame.exe!GuardedMain(const wchar_t * CmdLine, HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, int nCmdShow) Line 168	C++
UE4Editor-Win64-DebugGame.exe!WinMain(HINSTANCE__ * hInInstance, HINSTANCE__ * hPrevInstance, char * __formal, int nCmdShow) Line 261	C++
</code></pre>
<p>Related Properties:</p>
<pre><code>/** Always relevant for network (overrides bOnlyRelevantToOwner). */
UPROPERTY(Category=Replication, EditDefaultsOnly, BlueprintReadWrite)
uint8 bAlwaysRelevant:1;
</code></pre>
<h5 id="how-does-engine-check-if-strip-animation-data">How does engine check if strip animation data</h5>
<p><code>Strip Animation Data On Dedicated Server</code> was used in <code>UAnimSequence::Serialize()</code>:</p>
<pre><code>const bool bCookingTargetNeedsCompressedData = bIsCooking 
	&amp;&amp; (!UAnimationSettings::Get()-&gt;bStripAnimationDataOnDedicatedServer 
        || !bIsCookingForDedicatedServer 
        || bEnableRootMotion);
</code></pre>
<h5 id="rpc-related-engine-api">RPC Related Engine API</h5>
<p>Functions:</p>
<pre><code>/** Called on client when updated AttachmentReplication value is received for this actor. */
UFUNCTION()
virtual void OnRep_AttachmentReplication();
</code></pre>
<p>Properties:</p>
<pre><code>//Priority for this actor when checking for replication in a low bandwidth or saturated situation, higher priority means it is more likely to replicate
UPROPERTY(Category=Replication, EditDefaultsOnly, BlueprintReadWrite)
float NetPriority
</code></pre>
<h5 id="how-to-change-remoterole-when-spawning-actor">How to change RemoteRole when spawning Actor</h5>
<pre><code>/** This function should only be used in the constructor of classes that need to set the RemoteRole for backwards compatibility purposes */
void SetRemoteRoleForBackwardsCompat(const ENetRole InRemoteRole) { RemoteRole = InRemoteRole; }
</code></pre>
<h5 id="callstack-on-client-from-unetdriver-to-constructor-of-actor">Callstack on client from UNetDriver to constructor of Actor</h5>
<pre><code>UE4Editor-MyProj-Win64-DebugGame.dll!MyCharacter::MyCharacter() Line 7
	at E:\MyProj\Source\MyProj\Character\MyCharacter.cpp(7)
UE4Editor-MyProj-Win64-DebugGame.dll!InternalConstructor&lt;AFoliageActor&gt;(const FObjectInitializer &amp; X={...}) Line 3307
	at E:\unrealengine-4.26\Engine\Source\Runtime\CoreUObject\Public\UObject\Class.h(3307)
UE4Editor-CoreUObject.dll!StaticConstructObject_Internal(const FStaticConstructObjectParameters &amp; Params={...}) Line 3195
	at E:\unrealengine-4.26\Engine\Source\Runtime\CoreUObject\Private\UObject\UObjectGlobals.cpp(3195)
[Inline Frame] UE4Editor-Engine.dll!NewObject(UObject *) Line 1160
	at E:\unrealengine-4.26\Engine\Source\Runtime\CoreUObject\Public\UObject\UObjectGlobals.h(1160)
UE4Editor-Engine.dll!UWorld::SpawnActor(UClass * Class=0x000001b8ab457200, const FTransform * UserTransformPtr, const FActorSpawnParameters &amp; SpawnParameters={...}) Line 508
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\LevelActor.cpp(508)
UE4Editor-Engine.dll!UWorld::SpawnActorAbsolute(UClass * Class=0x000001b8ab457200, const FTransform &amp; AbsoluteTransform, const FActorSpawnParameters &amp; SpawnParameters={...}) Line 289
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\LevelActor.cpp(289)
UE4Editor-Engine.dll!UPackageMapClient::SerializeNewActor(FArchive &amp; Ar={...}, UActorChannel * Channel=0x000001b8a9235f00, AActor * &amp; Actor=0x0000000000000000) Line 609
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\PackageMapClient.cpp(609)
UE4Editor-Engine.dll!UActorChannel::ProcessBunch(FInBunch &amp; Bunch={...}) Line 2764
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\DataChannel.cpp(2764)
UE4Editor-Engine.dll!UActorChannel::ReceivedBunch(FInBunch &amp; Bunch={...}) Line 2734
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\DataChannel.cpp(2734)
UE4Editor-Engine.dll!UChannel::ReceivedSequencedBunch(FInBunch &amp; Bunch={...}) Line 412
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\DataChannel.cpp(412)
UE4Editor-Engine.dll!UChannel::ReceivedNextBunch(FInBunch &amp; Bunch={...}, bool &amp; bOutSkipAck=false) Line 833
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\DataChannel.cpp(833)
UE4Editor-Engine.dll!UChannel::ReceivedRawBunch(FInBunch &amp; Bunch={...}, bool &amp; bOutSkipAck=false) Line 517
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\DataChannel.cpp(517)
UE4Editor-Engine.dll!UNetConnection::ReceivedPacket(FBitReader &amp; Reader, bool bIsReinjectedPacket=64) Line 2783
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\NetConnection.cpp(2783)
UE4Editor-Engine.dll!UNetConnection::ReceivedRawPacket(void * InData, int Count=907) Line 1316
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\NetConnection.cpp(1316)
UE4Editor-OnlineSubsystemUtils.dll!UIpNetDriver::TickDispatch(float DeltaTime) Line 1370
	at E:\unrealengine-4.26\Engine\Plugins\Online\OnlineSubsystemUtils\Source\OnlineSubsystemUtils\Private\IpNetDriver.cpp(1370)
[Inline Frame] UE4Editor-Engine.dll!Invoke(void(UNetDriver::*)(float)) Line 65
	at E:\unrealengine-4.26\Engine\Source\Runtime\Core\Public\Templates\Invoke.h(65)
[Inline Frame] UE4Editor-Engine.dll!UE4Tuple_Private::TTupleBase&lt;TIntegerSequence&lt;unsigned int&gt;&gt;::ApplyAfter(void(UNetDriver::*)(float) &amp;) Line 299
	at E:\unrealengine-4.26\Engine\Source\Runtime\Core\Public\Templates\Tuple.h(299)
UE4Editor-Engine.dll!TBaseUObjectMethodDelegateInstance&lt;0,UNetDriver,void __cdecl(float),FDefaultDelegateUserPolicy&gt;::ExecuteIfSafe(float &lt;Params_0&gt;) Line 611
	at E:\unrealengine-4.26\Engine\Source\Runtime\Core\Public\Delegates\DelegateInstancesImpl.h(611)
UE4Editor-Engine.dll!TMulticastDelegate&lt;void __cdecl(float),FDefaultDelegateUserPolicy&gt;::Broadcast(float &lt;Params_0&gt;) Line 955
	at E:\unrealengine-4.26\Engine\Source\Runtime\Core\Public\Delegates\DelegateSignatureImpl.inl(955)
UE4Editor-Engine.dll!UWorld::Tick(ELevelTick TickType=-562797776, float DeltaSeconds=0.00000000) Line 1374
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\LevelTick.cpp(1374)
UE4Editor-Engine.dll!UGameEngine::Tick(float DeltaSeconds, bool bIdleMode=false) Line 1794
	at E:\unrealengine-4.26\Engine\Source\Runtime\Engine\Private\GameEngine.cpp(1794)
UE4Editor-Win64-DebugGame.exe!FEngineLoop::Tick() Line 4836
	at E:\unrealengine-4.26\Engine\Source\Runtime\Launch\Private\LaunchEngineLoop.cpp(4836)
[Inline Frame] UE4Editor-Win64-DebugGame.exe!EngineTick() Line 62
	at E:\unrealengine-4.26\Engine\Source\Runtime\Launch\Private\Launch.cpp(62)
UE4Editor-Win64-DebugGame.exe!GuardedMain(const wchar_t * CmdLine) Line 169
	at E:\unrealengine-4.26\Engine\Source\Runtime\Launch\Private\Launch.cpp(169)
UE4Editor-Win64-DebugGame.exe!WinMain(HINSTANCE__ * hInInstance=0x000000000000000a, HINSTANCE__ * hPrevInstance=0x0000000000000000, char * __formal=0x0000000000000000, int nCmdShow=0) Line 257
	at E:\unrealengine-4.26\Engine\Source\Runtime\Launch\Private\Windows\LaunchWindows.cpp(257)
[External Code]
</code></pre>
<h3 id="command--configuration">Command &amp; Configuration</h3>
<h5 id="netallowasyncloading--netdelayunmappedrpcs">net.AllowAsyncLoading &amp; net.DelayUnmappedRPCs</h5>
<pre><code>static TAutoConsoleVariable&lt;int32&gt; CVarAllowAsyncLoading(
	TEXT(&quot;net.AllowAsyncLoading&quot;),
	0,
	TEXT(&quot;Allow async loading of unloaded assets referenced in packets.&quot;
        &quot; If false the client will hitch and immediately load the asset,&quot;
        &quot; if true the packet will be delayed while the asset is async loaded.&quot;
        &quot; net.DelayUnmappedRPCs can be enabled to delay RPCs relying on async loading assets.&quot;)
);

static TAutoConsoleVariable&lt;int32&gt; CVarDelayUnmappedRPCs(
	TEXT(&quot;net.DelayUnmappedRPCs&quot;),
	0,
	TEXT(&quot;If true delay received RPCs with unmapped object references until they are received or loaded, &quot;)
	TEXT(&quot;if false RPCs will execute immediately with null parameters. &quot;)
	TEXT(&quot;This can be used with net.AllowAsyncLoading to avoid null asset parameters during async loads.&quot;),
	ECVF_Default);
</code></pre>
<h3 id="reference">Reference</h3>
<h5 id="documents">Documents</h5>
<p>Function call replication - Sending messages between server and client<br>
<a href="https://wiki.beyondunreal.com/Everything_you_ever_wanted_to_know_about_replication_%28but_were_afraid_to_ask%29#Function_call_replication_-_Sending_messages_between_server_and_client">https://wiki.beyondunreal.com/Everything_you_ever_wanted_to_know_about_replication_%28but_were_afraid_to_ask%29#Function_call_replication_-_Sending_messages_between_server_and_client</a></p>
<p>《Exploring in UE4》网络同步原理深入（上）[原理分析]<br>
<a href="https://zhuanlan.zhihu.com/p/34723199">https://zhuanlan.zhihu.com/p/34723199</a></p>
<p>《Exploring in UE4》网络同步原理深入（下）[原理分析]<br>
<a href="https://zhuanlan.zhihu.com/p/55596030">https://zhuanlan.zhihu.com/p/55596030</a></p>
<p><strong>Networking Insights (Experimental)</strong> was included in 4.25 preview.<br>
Unreal Insights now includes Networking Insights to visualize network gameplay data and identify performance bottlenecks or faulty code.</p>
<p>UE4.25: 网络新功能：PushModel<br>
<a href="https://blog.csdn.net/u014391423/article/details/106843424">https://blog.csdn.net/u014391423/article/details/106843424</a></p>
<hr>
<p><code>我是个过分认真的人，总想给生命一个交代。这种愚蠢的努力简直成了我的噩梦，当然也是最终的救赎。——《像我这样笨拙地生活》</code></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://dawnarc.com/tags/ue4/">UE4</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2019/06/ue4numeric-limits/" data-tooltip="[UE4]Numeric Limits">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2019/06/ue4fbx-export-and-import-related/" data-tooltip="[UE4]FBX Export and Import Related">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            <script src="https://utteranc.es/client.js"
  repo="dawnarc/dawnarc.github.io"
  issue-term="pathname"
  label="Comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 Neil Wang. All Rights Reserved. Powered by <A href="https://gohugo.io/"> Hugo</A> | Theme <A href="https://github.com/kakawait/hugo-tranquilpeak-theme/">Tranquilpeak</A>.
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2019/06/ue4numeric-limits/" data-tooltip="[UE4]Numeric Limits">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://dawnarc.com/2019/06/ue4fbx-export-and-import-related/" data-tooltip="[UE4]FBX Export and Import Related">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/0df91cdac5811a56ca485b0449d91b5e?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Neil Wang</h4>
    
      <div id="about-card-bio">久长唯有品格</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Yichang, Hubei
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://dawnarc.com/cover-v1.2.0.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

	<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/solarized-light.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://dawnarc.com/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  






    
  </body>
</html>

